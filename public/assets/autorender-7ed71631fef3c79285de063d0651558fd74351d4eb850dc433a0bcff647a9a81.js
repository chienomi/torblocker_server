var findEndOfMath=function(e,t,r){for(var n=r,a=0,i=e.length;n<t.length;){var d=t[n];if(a<=0&&t.slice(n,n+i)===e)return n;"\\"===d?n++:"{"===d?a++:"}"===d&&a--,n++}return-1},splitAtDelimiters=function(e,t,r,n){for(var a=[],i=0;i<e.length;i++)if("text"===e[i].type){var d,l=e[i].data,o=!0,s=0;for(d=l.indexOf(t),d!==-1&&(s=d,a.push({type:"text",data:l.slice(0,s)}),o=!1);;){if(o){if(d=l.indexOf(t,s),d===-1)break;a.push({type:"text",data:l.slice(s,d)}),s=d}else{if(d=findEndOfMath(r,l,s+t.length),d===-1)break;a.push({type:"math",data:l.slice(s+t.length,d),rawData:l.slice(s,d+r.length),display:n}),s=d+r.length}o=!o}a.push({type:"text",data:l.slice(s)})}else a.push(e[i]);return a},splitWithDelimiters=function(e,t){for(var r=[{type:"text",data:e}],n=0;n<t.length;n++){var a=t[n];r=splitAtDelimiters(r,a.left,a.right,a.display||!1)}return r},renderMathInText=function(e,t){for(var r=splitWithDelimiters(e,t),n=document.createDocumentFragment(),a=0;a<r.length;a++)if("text"===r[a].type)n.appendChild(document.createTextNode(r[a].data));else{var i=document.createElement("span"),d=r[a].data;try{katex.render(d,i,{displayMode:r[a].display})}catch(e){if(!(e instanceof katex.ParseError))throw e;console.error("KaTeX auto-render: Failed to parse `"+r[a].data+"` with ",e),n.appendChild(document.createTextNode(r[a].rawData));continue}n.appendChild(i)}return n},renderElem=function(e,t,r){for(var n=0;n<e.childNodes.length;n++){var a=e.childNodes[n];if(3===a.nodeType){var i=renderMathInText(a.textContent,t);n+=i.childNodes.length-1,e.replaceChild(i,a)}else if(1===a.nodeType){var d=r.indexOf(a.nodeName.toLowerCase())===-1;d&&renderElem(a,t,r)}}},defaultOptions={delimiters:[{left:"$$",right:"$$",display:!0},{left:"\\[",right:"\\]",display:!0},{left:"\\(",right:"\\)",display:!1}],ignoredTags:["script","noscript","style","textarea","pre","code"]},extend=function(e){for(var t,r,n=1,a=arguments.length;n<a;n++){t=arguments[n];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},renderMathInElement=function(e,t){if(!e)throw new Error("No element provided to render");t=extend({},defaultOptions,t),renderElem(e,t.delimiters,t.ignoredTags)};