if(function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(e){function t(){var t=this;t.top="auto",t.left="auto",t.right="auto",t.bottom="auto",t.set=function(n,o){e.isNumeric(o)&&(t[n]=Math.round(o))}}function n(e,t,n){function o(o,i){s(),e.data(m)||(o?(i&&e.data(v,!0),n.showTip(e)):(b.tipOpenImminent=!0,c=setTimeout(function(){c=null,r()},t.intentPollInterval)))}function i(o){s(),b.tipOpenImminent=!1,e.data(m)&&(e.data(v,!1),o?n.hideTip(e):(b.delayInProgress=!0,c=setTimeout(function(){c=null,n.hideTip(e),b.delayInProgress=!1},t.closeDelay)))}function r(){var i=Math.abs(b.previousX-b.currentX),r=Math.abs(b.previousY-b.currentY),s=i+r;t.intentSensitivity>s?n.showTip(e):(b.previousX=b.currentX,b.previousY=b.currentY,o())}function s(){c=clearTimeout(c),b.delayInProgress=!1}function a(){n.resetPosition(e)}var c=null;this.show=o,this.hide=i,this.cancel=s,this.resetPosition=a}function o(){function e(e,i,s,a,c){var l,f=i.split("-")[0],d=new t;switch(l=r(e)?o(e,f):n(e,f),i){case"n":d.set("left",l.left-s/2),d.set("bottom",b.windowHeight-l.top+c);break;case"e":d.set("left",l.left+c),d.set("top",l.top-a/2);break;case"s":d.set("left",l.left-s/2),d.set("top",l.top+c);break;case"w":d.set("top",l.top-a/2),d.set("right",b.windowWidth-l.left+c);break;case"nw":d.set("bottom",b.windowHeight-l.top+c),d.set("right",b.windowWidth-l.left-20);break;case"nw-alt":d.set("left",l.left),d.set("bottom",b.windowHeight-l.top+c);break;case"ne":d.set("left",l.left-20),d.set("bottom",b.windowHeight-l.top+c);break;case"ne-alt":d.set("bottom",b.windowHeight-l.top+c),d.set("right",b.windowWidth-l.left);break;case"sw":d.set("top",l.top+c),d.set("right",b.windowWidth-l.left-20);break;case"sw-alt":d.set("left",l.left),d.set("top",l.top+c);break;case"se":d.set("left",l.left-20),d.set("top",l.top+c);break;case"se-alt":d.set("top",l.top+c),d.set("right",b.windowWidth-l.left)}return d}function n(e,t){var n,o,i=e.offset(),r=e.outerWidth(),s=e.outerHeight();switch(t){case"n":n=i.left+r/2,o=i.top;break;case"e":n=i.left+r,o=i.top+s/2;break;case"s":n=i.left+r/2,o=i.top+s;break;case"w":n=i.left,o=i.top+s/2;break;case"nw":n=i.left,o=i.top;break;case"ne":n=i.left+r,o=i.top;break;case"sw":n=i.left,o=i.top+s;break;case"se":n=i.left+r,o=i.top+s}return{top:o,left:n}}function o(e,t){function n(){p.push(l.matrixTransform(d))}var o,i,r,s,a=e.closest("svg")[0],c=e[0],l=a.createSVGPoint(),f=c.getBBox(),d=c.getScreenCTM(),u=f.width/2,h=f.height/2,p=[],g=["nw","n","ne","e","se","s","sw","w"];if(l.x=f.x,l.y=f.y,n(),l.x+=u,n(),l.x+=u,n(),l.y+=h,n(),l.y+=h,n(),l.x-=u,n(),l.x-=u,n(),l.y-=h,n(),p[0].y!==p[1].y||p[0].x!==p[7].x)for(i=Math.atan2(d.b,d.a)*E,r=Math.ceil((i%360-22.5)/45),1>r&&(r+=8);r--;)g.push(g.shift());for(s=0;p.length>s;s++)if(g[s]===t){o=p[s];break}return{top:o.y+b.scrollTop,left:o.x+b.scrollLeft}}this.compute=e}function i(n){function i(e){e.data(m,!0),E.queue(function(t){r(e),t()})}function r(e){var t;if(e.data(m)){if(b.isTipOpen)return b.isClosing||s(b.activeHover),void E.delay(100).queue(function(t){r(e),t()});e.trigger("powerTipPreRender"),t=l(e),t&&(E.empty().append(t),e.trigger("powerTipRender"),b.activeHover=e,b.isTipOpen=!0,E.data(w,n.mouseOnToPopup),n.followMouse?a():(y(e),b.isFixedTipOpen=!0),E.fadeIn(n.fadeInTime,function(){b.desyncTimeout||(b.desyncTimeout=setInterval(N,500)),e.trigger("powerTipOpen")}))}}function s(e){b.isClosing=!0,b.activeHover=null,b.isTipOpen=!1,b.desyncTimeout=clearInterval(b.desyncTimeout),e.data(m,!1),e.data(v,!1),E.fadeOut(n.fadeOutTime,function(){var o=new t;b.isClosing=!1,b.isFixedTipOpen=!1,E.removeClass(),o.set("top",b.currentY+n.offset),o.set("left",b.currentX+n.offset),E.css(o),e.trigger("powerTipClose")})}function a(){if(!b.isFixedTipOpen&&(b.isTipOpen||b.tipOpenImminent&&E.data(C))){var e,o,i=E.outerWidth(),r=E.outerHeight(),s=new t;s.set("top",b.currentY+n.offset),s.set("left",b.currentX+n.offset),e=f(s,i,r),e!==S.none&&(o=d(e),1===o?e===S.right?s.set("left",b.windowWidth-i):e===S.bottom&&s.set("top",b.scrollTop+b.windowHeight-r):(s.set("left",b.currentX-i-n.offset),s.set("top",b.currentY-r-n.offset))),E.css(s)}}function y(t){var o,i;n.smartPlacement?(o=e.fn.powerTip.smartPlacementLists[n.placement],e.each(o,function(e,n){var o=f(R(t,n),E.outerWidth(),E.outerHeight());return i=n,o!==S.none&&void 0})):(R(t,n.placement),i=n.placement),E.addClass(i)}function R(e,o){var i,r,s=0,a=new t;a.set("top",0),a.set("left",0),E.css(a);do i=E.outerWidth(),r=E.outerHeight(),a=T.compute(e,o,i,r,n.offset),E.css(a);while(5>=++s&&(i!==E.outerWidth()||r!==E.outerHeight()));return a}function N(){var e=!1;!b.isTipOpen||b.isClosing||b.delayInProgress||(b.activeHover.data(m)===!1||b.activeHover.is(":disabled")?e=!0:c(b.activeHover)||b.activeHover.is(":focus")||b.activeHover.data(v)||(E.data(w)?c(E)||(e=!0):e=!0),e&&s(b.activeHover))}var T=new o,E=e("#"+n.popupId);0===E.length&&(E=e("<div/>",{id:n.popupId}),0===p.length&&(p=e("body")),p.append(E)),n.followMouse&&(E.data(C)||(u.on("mousemove",a),h.on("scroll",a),E.data(C,!0))),n.mouseOnToPopup&&E.on({mouseenter:function(){E.data(w)&&b.activeHover&&b.activeHover.data(g).cancel()},mouseleave:function(){b.activeHover&&b.activeHover.data(g).hide()}}),this.showTip=i,this.hideTip=s,this.resetPosition=y}function r(e){return window.SVGElement&&e[0]instanceof SVGElement}function s(){b.mouseTrackingActive||(b.mouseTrackingActive=!0,e(function(){b.scrollLeft=h.scrollLeft(),b.scrollTop=h.scrollTop(),b.windowWidth=h.width(),b.windowHeight=h.height()}),u.on("mousemove",a),h.on({resize:function(){b.windowWidth=h.width(),b.windowHeight=h.height()},scroll:function(){var e=h.scrollLeft(),t=h.scrollTop();e!==b.scrollLeft&&(b.currentX+=e-b.scrollLeft,b.scrollLeft=e),t!==b.scrollTop&&(b.currentY+=t-b.scrollTop,b.scrollTop=t)}}))}function a(e){b.currentX=e.pageX,b.currentY=e.pageY}function c(e){var t=e.offset(),n=e[0].getBoundingClientRect(),o=n.right-n.left,i=n.bottom-n.top;return b.currentX>=t.left&&b.currentX<=t.left+o&&b.currentY>=t.top&&b.currentY<=t.top+i}function l(t){var n,o,i=t.data(R),r=t.data(N),s=t.data(T);return i?(e.isFunction(i)&&(i=i.call(t[0])),o=i):r?(e.isFunction(r)&&(r=r.call(t[0])),r.length>0&&(o=r.clone(!0,!0))):s&&(n=e("#"+s),n.length>0&&(o=n.html())),o}function f(e,t,n){var o=b.scrollTop,i=b.scrollLeft,r=o+b.windowHeight,s=i+b.windowWidth,a=S.none;return(o>e.top||o>Math.abs(e.bottom-b.windowHeight)-n)&&(a|=S.top),(e.top+n>r||Math.abs(e.bottom-b.windowHeight)>r)&&(a|=S.bottom),(i>e.left||e.right+t>s)&&(a|=S.left),(e.left+t>s||i>e.right)&&(a|=S.right),a}function d(e){for(var t=0;e;)e&=e-1,t++;return t}var u=e(document),h=e(window),p=e("body"),g="displayController",m="hasActiveHover",v="forcedOpen",C="hasMouseMove",w="mouseOnToPopup",y="originalTitle",R="powertip",N="powertipjq",T="powertiptarget",E=180/Math.PI,b={isTipOpen:!1,isFixedTipOpen:!1,isClosing:!1,tipOpenImminent:!1,activeHover:null,currentX:0,currentY:0,previousX:0,previousY:0,desyncTimeout:null,mouseTrackingActive:!1,delayInProgress:!1,windowWidth:0,windowHeight:0,scrollTop:0,scrollLeft:0},S={none:0,top:1,bottom:2,left:4,right:8};e.fn.powerTip=function(t,o){if(!this.length)return this;if("string"===e.type(t)&&e.powerTip[t])return e.powerTip[t].call(this,this,o);var r=e.extend({},e.fn.powerTip.defaults,t),a=new i(r);return s(),this.each(function(){var t,o=e(this),i=o.data(R),s=o.data(N),c=o.data(T);o.data(g)&&e.powerTip.destroy(o),t=o.attr("title"),i||c||s||!t||(o.data(R,t),o.data(y,t),o.removeAttr("title")),o.data(g,new n(o,r,a))}),r.manual||this.on({"mouseenter.powertip":function(t){e.powerTip.show(this,t)},"mouseleave.powertip":function(){e.powerTip.hide(this)},"focus.powertip":function(){e.powerTip.show(this)},"blur.powertip":function(){e.powerTip.hide(this,!0)},"keydown.powertip":function(t){27===t.keyCode&&e.powerTip.hide(this,!0)}}),this},e.fn.powerTip.defaults={fadeInTime:200,fadeOutTime:100,followMouse:!1,popupId:"powerTip",intentSensitivity:7,intentPollInterval:100,closeDelay:100,placement:"n",smartPlacement:!1,offset:10,mouseOnToPopup:!1,manual:!1},e.fn.powerTip.smartPlacementLists={n:["n","ne","nw","s"],e:["e","ne","se","w","nw","sw","n","s","e"],s:["s","se","sw","n"],w:["w","nw","sw","e","ne","se","n","s","w"],nw:["nw","w","sw","n","s","se","nw"],ne:["ne","e","se","n","s","sw","ne"],sw:["sw","w","nw","s","n","ne","sw"],se:["se","e","ne","s","n","nw","se"],"nw-alt":["nw-alt","n","ne-alt","sw-alt","s","se-alt","w","e"],"ne-alt":["ne-alt","n","nw-alt","se-alt","s","sw-alt","e","w"],"sw-alt":["sw-alt","s","se-alt","nw-alt","n","ne-alt","w","e"],"se-alt":["se-alt","s","sw-alt","ne-alt","n","nw-alt","e","w"]},e.powerTip={show:function(t,n){return n?(a(n),b.previousX=n.pageX,b.previousY=n.pageY,e(t).data(g).show()):e(t).first().data(g).show(!0,!0),t},reposition:function(t){return e(t).first().data(g).resetPosition(),t},hide:function(t,n){return t?e(t).first().data(g).hide(n):b.activeHover&&b.activeHover.data(g).hide(!0),t},destroy:function(t){return e(t).off(".powertip").each(function(){var t=e(this),n=[y,g,m,v];t.data(y)&&(t.attr("title",t.data(y)),n.push(R)),t.removeData(n)}),t}},e.powerTip.showTip=e.powerTip.show,e.powerTip.closeTip=e.powerTip.hide}),"undefined"==typeof jQuery)throw new Error("jquery-confirm requires jQuery");var jconfirm,Jconfirm;!function(e){e.fn.confirm=function(t,n){return"undefined"==typeof t&&(t={}),"string"==typeof t&&(t={content:t,title:!!n&&n}),e(this).each(function(){var n=e(this);n.on("click",function(o){o.preventDefault();var i=e.extend({},t);n.attr("data-title")&&(i.title=n.attr("data-title")),n.attr("data-content")&&(i.content=n.attr("data-content")),i.$target=n,n.attr("href")&&!t.confirm&&(i.confirm=function(){location.href=n.attr("href")}),e.confirm(i)})}),e(this)},e.confirm=function(e,t){return"undefined"==typeof e&&(e={}),"string"==typeof e&&(e={content:e,title:!!t&&t}),jconfirm(e)},e.alert=function(e,t){return"undefined"==typeof e&&(e={}),"string"==typeof e&&(e={content:e,title:!!t&&t}),e.cancelButton=!1,jconfirm(e)},e.dialog=function(e,t){return"undefined"==typeof e&&(e={}),"string"==typeof e&&(e={content:e,title:!!t&&t}),e.cancelButton=!1,e.confirmButton=!1,e.confirmKeys=[13],jconfirm(e)},jconfirm=function(t){"undefined"==typeof t&&(t={}),jconfirm.defaults&&e.extend(jconfirm.pluginDefaults,jconfirm.defaults);var t=e.extend({},jconfirm.pluginDefaults,t);return new Jconfirm(t)},Jconfirm=function(t){e.extend(this,t),this._init()},Jconfirm.prototype={_init:function(){var e=this;this._rand=Math.round(99999*Math.random()),this._buildHTML(),this._bindEvents(),setTimeout(function(){e.open(),e._watchContent()},0)},_buildHTML:function(){var t=this;this.animation="anim-"+this.animation.toLowerCase(),this.closeAnimation="anim-"+this.closeAnimation.toLowerCase(),this.theme="jconfirm-"+this.theme.toLowerCase(),"anim-none"==this.animation&&(this.animationSpeed=0),this._lastFocused=e("body").find(":focus"),this.$el=e(this.template).appendTo(this.container).addClass(this.theme),this.$el.find(".jconfirm-box-container").addClass(this.columnClass),this.$el.find(".jconfirm-bg").css(this._getCSS(this.animationSpeed,1)),this.$el.find(".jconfirm-bg").css("opacity",this.opacity),this.$b=this.$el.find(".jconfirm-box").css(this._getCSS(this.animationSpeed,this.animationBounce)).addClass(this.animation),this.$body=this.$b,this.rtl&&this.$el.addClass("rtl"),this._contentReady=e.Deferred(),this._modalReady=e.Deferred(),this.$title=this.$el.find(".title"),this.contentDiv=this.$el.find("div.content"),this.$content=this.contentDiv,this.$contentPane=this.$el.find(".content-pane"),this.$icon=this.$el.find(".icon-c"),this.$closeIcon=this.$el.find(".closeIcon"),this.$contentPane.css(this._getCSS(this.animationSpeed,1)),this.setTitle(),this.setIcon(),this._setButtons(),this.closeIconClass&&this.$closeIcon.html('<i class="'+this.closeIconClass+'"></i>'),t._contentHash=this._hash(t.$content.html()),e.when(this._contentReady,this._modalReady).then(function(){t.setContent(),t.setTitle(),t.setIcon()}),this._getContent(),this._imagesLoaded(),this.autoClose&&this._startCountDown()},_unwatchContent:function(){clearInterval(this._timer)},_hash:function(){return btoa(encodeURIComponent(this.$content.html()))},_watchContent:function(){var e=this;this._timer=setInterval(function(){var t=e._hash(e.$content.html());e._contentHash!=t&&(e._contentHash=t,e.setDialogCenter(),e._imagesLoaded())},this.watchInterval)},_bindEvents:function(){var t=this,n=!1;this.$el.find(".jconfirm-scrollpane").click(function(){n||(t.backgroundDismiss?(t.cancel(),t.close()):(t.$b.addClass("hilight"),setTimeout(function(){t.$b.removeClass("hilight")},800))),n=!1}),this.$el.find(".jconfirm-box").click(function(){n=!0}),this.$confirmButton&&this.$confirmButton.click(function(e){e.preventDefault();var n=t.confirm(t.$b);t._stopCountDown(),t.onAction("confirm"),("undefined"==typeof n||n)&&t.close()}),this.$cancelButton&&this.$cancelButton.click(function(e){e.preventDefault();var n=t.cancel(t.$b);t._stopCountDown(),t.onAction("cancel"),("undefined"==typeof n||n)&&t.close()}),this.$closeButton&&this.$closeButton.click(function(e){e.preventDefault(),t._stopCountDown(),t.cancel(),t.onAction("close"),t.close()}),this.keyboardEnabled&&setTimeout(function(){e(window).on("keyup."+this._rand,function(e){t.reactOnKey(e)})},500),e(window).on("resize."+this._rand,function(){t.setDialogCenter(!0)})},_getCSS:function(e,t){return{"-webkit-transition-duration":e/1e3+"s","transition-duration":e/1e3+"s","-webkit-transition-timing-function":"cubic-bezier(.36,1.1,.2, "+t+")","transition-timing-function":"cubic-bezier(.36,1.1,.2, "+t+")"}},_imagesLoaded:function(){var t=this;e.each(this.$content.find("img:not(.loaded)"),function(n,o){var i=setInterval(function(){var n=e(o).css("height");"0px"!==n&&(e(o).addClass("loaded"),t.setDialogCenter(),clearInterval(i))},40)})},_setButtons:function(){this.$btnc=this.$el.find(".buttons"),this.confirmButton&&""!==e.trim(this.confirmButton)&&(this.$confirmButton=e('<button type="button" class="btn">'+this.confirmButton+"</button>").appendTo(this.$btnc).addClass(this.confirmButtonClass)),this.cancelButton&&""!==e.trim(this.cancelButton)&&(this.$cancelButton=e('<button type="button" class="btn">'+this.cancelButton+"</button>").appendTo(this.$btnc).addClass(this.cancelButtonClass)),this.confirmButton||this.cancelButton||this.$btnc.hide(),this.confirmButton||this.cancelButton||null!==this.closeIcon||(this.$closeButton=this.$b.find(".closeIcon").show()),this.closeIcon===!0&&(this.$closeButton=this.$b.find(".closeIcon").show())},setTitle:function(e){this.title="undefined"!=typeof e?e:this.title,this.$title.html(this.title||"")},setIcon:function(e){this.title="undefined"!=typeof string?e:this.title,this.$icon.html(this.icon?'<i class="'+this.icon+'"></i>':"")},setContent:function(e){this.content="undefined"==typeof e?this.content:e,""==this.content?(this.$content.html(this.content),this.$contentPane.hide()):(this.$content.html(this.content),this.$contentPane.show()),this.$content.hasClass("loading")&&(this.$content.removeClass("loading"),this.$btnc.find("button").prop("disabled",!1))},_getContent:function(t){var n=this;if(t=t?t:this.content,this._isAjax=!1,this.content)if("string"==typeof this.content)if("url:"===this.content.substr(0,4).toLowerCase()){this._isAjax=!0,this.$content.addClass("loading"),this.$btnc.find("button").prop("disabled",!0);var o=this.content.substring(4,this.content.length);e.get(o).done(function(e){n.content=e,n._contentReady.resolve()}).always(function(e,t,o){"function"==typeof n.contentLoaded&&n.contentLoaded(e,t,o)})}else this.setContent(this.content),this._contentReady.reject();else if("function"==typeof this.content){this.$content.addClass("loading"),this.$btnc.find("button").attr("disabled","disabled");var i=this.content(this);"object"!=typeof i?console.error("The content function must return jquery promise."):"function"!=typeof i.always?console.error("The object returned is not a jquery promise."):(this._isAjax=!0,i.always(function(){n._contentReady.resolve()}))}else console.error("Invalid option for property content, passed: "+typeof this.content);else this.content="",this.setContent(this.content),this._contentReady.reject();this.setDialogCenter()},_stopCountDown:function(){clearInterval(this.timerInterval),this.$cd&&this.$cd.remove()},_startCountDown:function(){var t=this.autoClose.split("|");if(/cancel/.test(t[0])&&"alert"===this.type)return!1;if(/confirm|cancel/.test(t[0])){this.$cd=e('<span class="countdown">').appendTo(this["$"+t[0]+"Button"]);var n=this;n.$cd.parent().click();var o=t[1]/1e3;this.timerInterval=setInterval(function(){n.$cd.html(" ("+(o-=1)+")"),0===o&&(n.$cd.html(""),n.$cd.parent().trigger("click"),clearInterval(n.timerInterval))},1e3)}else console.error("Invalid option "+t[0]+", must be confirm/cancel")},reactOnKey:function t(n){var o=e(".jconfirm");if(o.eq(o.length-1)[0]!==this.$el[0])return!1;var t=n.which;return(!this.contentDiv.find(":input").is(":focus")||!/13|32/.test(t))&&(e.inArray(t,this.cancelKeys)!==-1&&(this.$cancelButton?this.$cancelButton.click():this.close()),void(e.inArray(t,this.confirmKeys)!==-1&&this.$confirmButton&&this.$confirmButton.click()))},setDialogCenter:function(){if("none"==this.$contentPane.css("display"))var t=0,n=0;else{var t=this.$content.outerHeight(),n=this.$contentPane.height();0==n&&(n=t)}var o=100,i=this.$content.outerWidth();this.$content.css({clip:"rect(0px "+(o+i)+"px "+t+"px -"+o+"px)"}),this.$contentPane.css({height:t});var r=e(window).height(),s=this.$b.outerHeight()-n+t,a=(r-s)/2,c=100;if(s>r-c){var l={"margin-top":c/2,"margin-bottom":c/2};e("body").addClass("jconfirm-noscroll")}else{var l={"margin-top":a};e("body").removeClass("jconfirm-noscroll")}this.$b.css(l)},close:function(){var t=this;if(this.isClosed())return!1;"function"==typeof this.onClose&&this.onClose(),this._unwatchContent(),t._lastFocused.focus(),e(window).unbind("resize."+this._rand),this.keyboardEnabled&&e(window).unbind("keyup."+this._rand),t.$el.find(".jconfirm-bg").removeClass("seen"),e("body").removeClass("jconfirm-noscroll"),this.$b.addClass(this.closeAnimation);var n="anim-none"==this.closeAnimation?0:this.animationSpeed;return setTimeout(function(){t.$el.remove()},25*n/100),jconfirm.record.closed+=1,jconfirm.record.currentlyOpen-=1,!0},open:function(){var e=this;if(this.isClosed())return!1;e.$el.find(".jconfirm-bg").addClass("seen"),this.$b.removeClass(this.animation),this.$b.find("input[autofocus]:visible:first").focus(),jconfirm.record.opened+=1,jconfirm.record.currentlyOpen+=1,"function"==typeof this.onOpen&&this.onOpen();var t="jconfirm-box"+this._rand;return this.$b.attr("aria-labelledby",t).attr("tabindex",-1).focus(),this.$title?this.$title.attr("id",t):this.$content&&this.$content.attr("id",t),setTimeout(function(){e.$b.css({"transition-property":e.$b.css("transition-property")+", margin"}),e._modalReady.resolve()},this.animationSpeed),!0},isClosed:function(){return""===this.$el.css("display")}},jconfirm.pluginDefaults={template:'<div class="jconfirm"><div class="jconfirm-bg"></div><div class="jconfirm-scrollpane"><div class="container"><div class="row"><div class="jconfirm-box-container"><div class="jconfirm-box" role="dialog" aria-labelledby="labelled" tabindex="-1"><div class="closeIcon">&times;</div><div class="title-c"><span class="icon-c"></span><span class="title"></span></div><div class="content-pane"><div class="content"></div></div><div class="buttons"></div><div class="jquery-clear"></div></div></div></div></div></div></div>',title:"Hello",content:"Are you sure to continue?",contentLoaded:function(){},icon:"",opacity:.2,confirmButton:"Okay",cancelButton:"Close",confirmButtonClass:"btn-default",cancelButtonClass:"btn-default",theme:"white",animation:"zoom",closeAnimation:"scale",animationSpeed:500,animationBounce:1.2,keyboardEnabled:!1,rtl:!1,confirmKeys:[13],cancelKeys:[27],container:"body",confirm:function(){},cancel:function(){},backgroundDismiss:!1,autoClose:!1,closeIcon:null,closeIconClass:!1,watchInterval:100,columnClass:"col-md-4 col-md-offset-4 col-sm-6 col-sm-offset-3 col-xs-10 col-xs-offset-1",onOpen:function(){},onClose:function(){},onAction:function(){}},jconfirm.record={opened:0,closed:0,currentlyOpen:0}}(jQuery),function(e,t){"function"==typeof define&&define.amd?define(e):"undefined"!=typeof module&&"object"==typeof exports?module.exports=e():t.rangy=e()}(function(){function e(e,t){var n=typeof e[t];return n==y||!(n!=w||!e[t])||"unknown"==n}function t(e,t){return!(typeof e[t]!=w||!e[t])}function n(e,t){return typeof e[t]!=R}function o(e){return function(t,n){for(var o=n.length;o--;)if(!e(t,n[o]))return!1;return!0}}function i(e){return e&&S(e,b)&&A(e,E)}function r(e){return t(e,"body")?e.body:e.getElementsByTagName("body")[0]}function s(t){typeof console!=R&&e(console,"log")&&console.log(t)}function a(e,t){D&&t?alert(e):s(e)}function c(e){P.initialized=!0,P.supported=!1,a("Rangy is not supported in this environment. Reason: "+e,P.config.alertOnFail)}function l(e){a("Rangy warning: "+e,P.config.alertOnWarn)}function f(e){return e.message||e.description||String(e)}function d(){if(D&&!P.initialized){var t,n=!1,o=!1;e(document,"createRange")&&(t=document.createRange(),S(t,T)&&A(t,N)&&(n=!0));var a=r(document);if(!a||"body"!=a.nodeName.toLowerCase())return void c("No body element found");if(a&&e(a,"createTextRange")&&(t=a.createTextRange(),i(t)&&(o=!0)),!n&&!o)return void c("Neither Range nor TextRange are available");P.initialized=!0,P.features={implementsDomRange:n,implementsTextRange:o};var l,d;for(var u in x)(l=x[u])instanceof g&&l.init(l,P);for(var h=0,p=$.length;h<p;++h)try{$[h](P)}catch(e){d="Rangy init listener threw an exception. Continuing. Detail: "+f(e),s(d)}}}function u(e,t,n){n&&(e+=" in module "+n.name),P.warn("DEPRECATED: "+e+" is deprecated. Please use "+t+" instead.")}function h(e,t,n,o){e[t]=function(){return u(t,n,o),e[n].apply(e,I.toArray(arguments))}}function p(e){e=e||window,d();for(var t=0,n=k.length;t<n;++t)k[t](e)}function g(e,t,n){this.name=e,this.dependencies=t,this.initialized=!1,this.supported=!1,this.initializer=n}function m(e,t,n){var o=new g(e,t,function(t){if(!t.initialized){t.initialized=!0;try{n(P,t),t.supported=!0}catch(t){var o="Module '"+e+"' failed to load: "+f(t);s(o),t.stack&&s(t.stack)}}});return x[e]=o,o}function v(){}function C(){}var w="object",y="function",R="undefined",N=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],T=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],E=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],b=["collapse","compareEndPoints","duplicate","moveToElementText","parentElement","select","setEndPoint","getBoundingClientRect"],S=o(e),O=o(t),A=o(n),_=[].forEach?function(e,t){e.forEach(t)}:function(e,t){for(var n=0,o=e.length;n<o;++n)t(e[n],n)},x={},D=typeof window!=R&&typeof document!=R,I={isHostMethod:e,isHostObject:t,isHostProperty:n,areHostMethods:S,areHostObjects:O,areHostProperties:A,isTextRange:i,getBody:r,forEach:_},P={version:"1.3.1-dev",initialized:!1,isBrowser:D,supported:!0,util:I,features:{},modules:x,config:{alertOnFail:!1,alertOnWarn:!1,preferTextRange:!1,autoInitialize:typeof rangyAutoInitialize==R||rangyAutoInitialize}};P.fail=c,P.warn=l;var H;({}).hasOwnProperty?(I.extend=H=function(e,t,n){var o,i;for(var r in t)t.hasOwnProperty(r)&&(o=e[r],i=t[r],n&&null!==o&&"object"==typeof o&&null!==i&&"object"==typeof i&&H(o,i,!0),e[r]=i);return t.hasOwnProperty("toString")&&(e.toString=t.toString),e},I.createOptions=function(e,t){var n={};return H(n,t),e&&H(n,e),n}):c("hasOwnProperty not supported"),D||c("Rangy can only run in a browser"),function(){var e;if(D){var t=document.createElement("div");t.appendChild(document.createElement("span"));var n=[].slice;try{1==n.call(t.childNodes,0)[0].nodeType&&(e=function(e){return n.call(e,0)})}catch(e){}}e||(e=function(e){for(var t=[],n=0,o=e.length;n<o;++n)t[n]=e[n];return t}),I.toArray=e}();var B;D&&(e(document,"addEventListener")?B=function(e,t,n){e.addEventListener(t,n,!1)}:e(document,"attachEvent")?B=function(e,t,n){e.attachEvent("on"+t,n)}:c("Document does not have required addEventListener or attachEvent method"),I.addListener=B);var $=[];I.deprecationNotice=u,I.createAliasForDeprecatedMethod=h,P.init=d,P.addInitListener=function(e){P.initialized?e(P):$.push(e)};var k=[];P.addShimListener=function(e){k.push(e)},D&&(P.shim=P.createMissingNativeApi=p,h(P,"createMissingNativeApi","shim")),g.prototype={init:function(){for(var e,t,n=this.dependencies||[],o=0,i=n.length;o<i;++o){if(t=n[o],e=x[t],!(e&&e instanceof g))throw new Error("required module '"+t+"' not found");if(e.init(),!e.supported)throw new Error("required module '"+t+"' not supported")}this.initializer(this)},fail:function(e){throw this.initialized=!0,this.supported=!1,new Error(e)},warn:function(e){P.warn("Module "+this.name+": "+e)},deprecationNotice:function(e,t){P.warn("DEPRECATED: "+e+" in module "+this.name+" is deprecated. Please use "+t+" instead")},createError:function(e){return new Error("Error in Rangy "+this.name+" module: "+e)}},P.createModule=function(e){var t,n;2==arguments.length?(t=arguments[1],n=[]):(t=arguments[2],n=arguments[1]);var o=m(e,n,t);P.initialized&&P.supported&&o.init()},P.createCoreModule=function(e,t,n){m(e,t,n)},P.RangePrototype=v,P.rangePrototype=new v,P.selectionPrototype=new C,P.createCoreModule("DomUtil",[],function(e,t){function n(e){var t;return typeof e.namespaceURI==D||null===(t=e.namespaceURI)||"http://www.w3.org/1999/xhtml"==t}function o(e){var t=e.parentNode;return 1==t.nodeType?t:null}function i(e){for(var t=0;e=e.previousSibling;)++t;return t}function r(e){switch(e.nodeType){case 7:case 10:return 0;case 3:case 8:return e.length;default:return e.childNodes.length}}function s(e,t){var n,o=[];for(n=e;n;n=n.parentNode)o.push(n);for(n=t;n;n=n.parentNode)if($(o,n))return n;return null}function a(e,t,n){for(var o=n?t:t.parentNode;o;){if(o===e)return!0;o=o.parentNode}return!1}function c(e,t){return a(e,t,!0)}function l(e,t,n){for(var o,i=n?e:e.parentNode;i;){if(o=i.parentNode,o===t)return i;i=o}return null}function f(e){var t=e.nodeType;return 3==t||4==t||8==t}function d(e){if(!e)return!1;var t=e.nodeType;return 3==t||8==t}function u(e,t){var n=t.nextSibling,o=t.parentNode;return n?o.insertBefore(e,n):o.appendChild(e),e}function h(e,t,n){var o=e.cloneNode(!1);if(o.deleteData(0,t),e.deleteData(t,e.length-t),u(o,e),n)for(var r,s=0;r=n[s++];)r.node==e&&r.offset>t?(r.node=o,r.offset-=t):r.node==e.parentNode&&r.offset>i(e)&&++r.offset;return o}function p(e){if(9==e.nodeType)return e;if(typeof e.ownerDocument!=D)return e.ownerDocument;if(typeof e.document!=D)return e.document;if(e.parentNode)return p(e.parentNode);throw t.createError("getDocument: no document found for node")}function g(e){var n=p(e);if(typeof n.defaultView!=D)return n.defaultView;if(typeof n.parentWindow!=D)return n.parentWindow;throw t.createError("Cannot get a window object for node")}function m(e){if(typeof e.contentDocument!=D)return e.contentDocument;if(typeof e.contentWindow!=D)return e.contentWindow.document;throw t.createError("getIframeDocument: No Document object found for iframe element")}function v(e){if(typeof e.contentWindow!=D)return e.contentWindow;if(typeof e.contentDocument!=D)return e.contentDocument.defaultView;throw t.createError("getIframeWindow: No Window object found for iframe element")}function C(e){return e&&I.isHostMethod(e,"setTimeout")&&I.isHostObject(e,"document")}function w(e,t,n){var o;if(e?I.isHostProperty(e,"nodeType")?o=1==e.nodeType&&"iframe"==e.tagName.toLowerCase()?m(e):p(e):C(e)&&(o=e.document):o=document,!o)throw t.createError(n+"(): Parameter must be a Window object or DOM node");return o}function y(e){for(var t;t=e.parentNode;)e=t;return e}function R(e,n,o,r){var a,c,f,d,u;if(e==o)return n===r?0:n<r?-1:1;if(a=l(o,e,!0))return n<=i(a)?-1:1;if(a=l(e,o,!0))return i(a)<r?-1:1;if(c=s(e,o),!c)throw new Error("comparePoints error: nodes have no common ancestor");if(f=e===c?c:l(e,c,!0),d=o===c?c:l(o,c,!0),f===d)throw t.createError("comparePoints got to case 4 and childA and childB are the same!");for(u=c.firstChild;u;){if(u===f)return-1;if(u===d)return 1;u=u.nextSibling}}function N(e){var t;try{return t=e.parentNode,!1}catch(e){return!0}}function T(e){if(!e)return"[No node]";if(k&&N(e))return"[Broken node]";if(f(e))return'"'+e.data+'"';if(1==e.nodeType){var t=e.id?' id="'+e.id+'"':"";return"<"+e.nodeName+t+">[index:"+i(e)+",length:"+e.childNodes.length+"]["+(e.innerHTML||"[innerHTML not supported]").slice(0,25)+"]"}return e.nodeName}function E(e){for(var t,n=p(e).createDocumentFragment();t=e.firstChild;)n.appendChild(t);return n}function b(e,t,n){var o=P(e),i=e.createElement("div");i.contentEditable=""+!!n,t&&(i.innerHTML=t);var r=o.firstChild;return r?o.insertBefore(i,r):o.appendChild(i),i}function S(e){return e.parentNode.removeChild(e)}function O(e){this.root=e,this._next=e}function A(e){return new O(e)}function _(e,t){this.node=e,this.offset=t}function x(e){this.code=this[e],this.codeName=e,this.message="DOMException: "+this.codeName}var D="undefined",I=e.util,P=I.getBody;I.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||t.fail("document missing a Node creation method"),I.isHostMethod(document,"getElementsByTagName")||t.fail("document missing getElementsByTagName method");var H=document.createElement("div");I.areHostMethods(H,["insertBefore","appendChild","cloneNode"]||!I.areHostObjects(H,["previousSibling","nextSibling","childNodes","parentNode"]))||t.fail("Incomplete Element implementation"),I.isHostProperty(H,"innerHTML")||t.fail("Element is missing innerHTML property");var B=document.createTextNode("test");I.areHostMethods(B,["splitText","deleteData","insertData","appendData","cloneNode"]||!I.areHostObjects(H,["previousSibling","nextSibling","childNodes","parentNode"])||!I.areHostProperties(B,["data"]))||t.fail("Incomplete Text Node implementation");var $=function(e,t){for(var n=e.length;n--;)if(e[n]===t)return!0;return!1},k=!1;!function(){var t=document.createElement("b");t.innerHTML="1";var n=t.firstChild;t.innerHTML="<br />",k=N(n),e.features.crashyTextNodes=k}();var M;typeof window.getComputedStyle!=D?M=function(e,t){return g(e).getComputedStyle(e,null)[t]}:typeof document.documentElement.currentStyle!=D?M=function(e,t){return e.currentStyle?e.currentStyle[t]:""}:t.fail("No means of obtaining computed style properties found"),O.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var e,t,n=this._current=this._next;if(this._current)if(e=n.firstChild)this._next=e;else{for(t=null;n!==this.root&&!(t=n.nextSibling);)n=n.parentNode;this._next=t}return this._current},detach:function(){this._current=this._next=this.root=null}},_.prototype={equals:function(e){return!!e&&this.node===e.node&&this.offset==e.offset},inspect:function(){return"[DomPosition("+T(this.node)+":"+this.offset+")]"},toString:function(){return this.inspect()}},x.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11,INVALID_NODE_TYPE_ERR:24},x.prototype.toString=function(){return this.message},e.dom={arrayContains:$,isHtmlNamespace:n,parentElement:o,getNodeIndex:i,getNodeLength:r,getCommonAncestor:s,isAncestorOf:a,isOrIsAncestorOf:c,getClosestAncestorIn:l,isCharacterDataNode:f,isTextOrCommentNode:d,insertAfter:u,splitDataNode:h,getDocument:p,getWindow:g,getIframeWindow:v,getIframeDocument:m,getBody:P,isWindow:C,getContentDocument:w,getRootContainer:y,comparePoints:R,isBrokenNode:N,inspectNode:T,getComputedStyleProperty:M,createTestElement:b,removeNode:S,fragmentFromNodeChildren:E,createIterator:A,DomPosition:_},e.DOMException=x}),P.createCoreModule("DomRange",["DomUtil"],function(e){function t(e,t){return 3!=e.nodeType&&(j(e,t.startContainer)||j(e,t.endContainer))}function n(e){return e.document||W(e.startContainer)}function o(e){return q(e.startContainer)}function i(e){return new $(e.parentNode,L(e))}function r(e){return new $(e.parentNode,L(e)+1)}function s(e,t,n){var o=11==e.nodeType?e.firstChild:e;return M(t)?n==t.length?H.insertAfter(e,t):t.parentNode.insertBefore(e,0==n?t:z(t,n)):n>=t.childNodes.length?t.appendChild(e):t.insertBefore(e,t.childNodes[n]),o}function a(e,t,o){if(E(e),E(t),n(t)!=n(e))throw new k("WRONG_DOCUMENT_ERR");var i=F(e.startContainer,e.startOffset,t.endContainer,t.endOffset),r=F(e.endContainer,e.endOffset,t.startContainer,t.startOffset);return o?i<=0&&r>=0:i<0&&r>0}function c(e){
for(var t,o,i,r=n(e.range).createDocumentFragment();o=e.next();){if(t=e.isPartiallySelectedSubtree(),o=o.cloneNode(!t),t&&(i=e.getSubtreeIterator(),o.appendChild(c(i)),i.detach()),10==o.nodeType)throw new k("HIERARCHY_REQUEST_ERR");r.appendChild(o)}return r}function l(e,t,n){var o,i;n=n||{stop:!1};for(var r,s;r=e.next();)if(e.isPartiallySelectedSubtree()){if(t(r)===!1)return void(n.stop=!0);if(s=e.getSubtreeIterator(),l(s,t,n),s.detach(),n.stop)return}else for(o=H.createIterator(r);i=o.next();)if(t(i)===!1)return void(n.stop=!0)}function f(e){for(var t;e.next();)e.isPartiallySelectedSubtree()?(t=e.getSubtreeIterator(),f(t),t.detach()):e.remove()}function d(e){for(var t,o,i=n(e.range).createDocumentFragment();t=e.next();){if(e.isPartiallySelectedSubtree()?(t=t.cloneNode(!1),o=e.getSubtreeIterator(),t.appendChild(d(o)),o.detach()):e.remove(),10==t.nodeType)throw new k("HIERARCHY_REQUEST_ERR");i.appendChild(t)}return i}function u(e,t,n){var o,i=!(!t||!t.length),r=!!n;i&&(o=new RegExp("^("+t.join("|")+")$"));var s=[];return l(new p(e,(!1)),function(t){if((!i||o.test(t.nodeType))&&(!r||n(t))){var a=e.startContainer;if(t!=a||!M(a)||e.startOffset!=a.length){var c=e.endContainer;t==c&&M(c)&&0==e.endOffset||s.push(t)}}}),s}function h(e){var t="undefined"==typeof e.getName?"Range":e.getName();return"["+t+"("+H.inspectNode(e.startContainer)+":"+e.startOffset+", "+H.inspectNode(e.endContainer)+":"+e.endOffset+")]"}function p(e,t){if(this.range=e,this.clonePartiallySelectedTextNodes=t,!e.collapsed){this.sc=e.startContainer,this.so=e.startOffset,this.ec=e.endContainer,this.eo=e.endOffset;var n=e.commonAncestorContainer;this.sc===this.ec&&M(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc!==n||M(this.sc)?Y(this.sc,n,!0):this.sc.childNodes[this.so],this._last=this.ec!==n||M(this.ec)?Y(this.ec,n,!0):this.ec.childNodes[this.eo-1])}}function g(e){return function(t,n){for(var o,i=n?t:t.parentNode;i;){if(o=i.nodeType,V(e,o))return i;i=i.parentNode}return null}}function m(e,t){if(oe(e,t))throw new k("INVALID_NODE_TYPE_ERR")}function v(e,t){if(!V(t,e.nodeType))throw new k("INVALID_NODE_TYPE_ERR")}function C(e,t){if(t<0||t>(M(e)?e.length:e.childNodes.length))throw new k("INDEX_SIZE_ERR")}function w(e,t){if(te(e,!0)!==te(t,!0))throw new k("WRONG_DOCUMENT_ERR")}function y(e){if(ne(e,!0))throw new k("NO_MODIFICATION_ALLOWED_ERR")}function R(e,t){if(!e)throw new k(t)}function N(e,t){return t<=(M(e)?e.length:e.childNodes.length)}function T(e){return!!e.startContainer&&!!e.endContainer&&!(X&&(H.isBrokenNode(e.startContainer)||H.isBrokenNode(e.endContainer)))&&q(e.startContainer)==q(e.endContainer)&&N(e.startContainer,e.startOffset)&&N(e.endContainer,e.endOffset)}function E(e){if(!T(e))throw new Error("Range error: Range is not valid. This usually happens after DOM mutation. Range: ("+e.inspect()+")")}function b(e,t){E(e);var n=e.startContainer,o=e.startOffset,i=e.endContainer,r=e.endOffset,s=n===i;M(i)&&r>0&&r<i.length&&z(i,r,t),M(n)&&o>0&&o<n.length&&(n=z(n,o,t),s?(r-=o,i=n):i==n.parentNode&&r>=L(n)&&r++,o=0),e.setStartAndEnd(n,o,i,r)}function S(e){E(e);var t=e.commonAncestorContainer.parentNode.cloneNode(!1);return t.appendChild(e.cloneContents()),t.innerHTML}function O(e){e.START_TO_START=ce,e.START_TO_END=le,e.END_TO_END=fe,e.END_TO_START=de,e.NODE_BEFORE=ue,e.NODE_AFTER=he,e.NODE_BEFORE_AND_AFTER=pe,e.NODE_INSIDE=ge}function A(e){O(e),O(e.prototype)}function _(e,t){return function(){E(this);var n,o,i=this.startContainer,s=this.startOffset,a=this.commonAncestorContainer,c=new p(this,(!0));i!==a&&(n=Y(i,a,!0),o=r(n),i=o.node,s=o.offset),l(c,y),c.reset();var f=e(c);return c.detach(),t(this,i,s,i,s),f}}function x(n,o){function s(e,t){return function(n){v(n,G),v(q(n),K);var o=(e?i:r)(n);(t?a:c)(this,o.node,o.offset)}}function a(e,t,n){var i=e.endContainer,r=e.endOffset;t===e.startContainer&&n===e.startOffset||(q(t)==q(i)&&1!=F(t,n,i,r)||(i=t,r=n),o(e,t,n,i,r))}function c(e,t,n){var i=e.startContainer,r=e.startOffset;t===e.endContainer&&n===e.endOffset||(q(t)==q(i)&&F(t,n,i,r)!=-1||(i=t,r=n),o(e,i,r,t,n))}var l=function(){};l.prototype=e.rangePrototype,n.prototype=new l,B.extend(n.prototype,{setStart:function(e,t){m(e,!0),C(e,t),a(this,e,t)},setEnd:function(e,t){m(e,!0),C(e,t),c(this,e,t)},setStartAndEnd:function(){var e=arguments,t=e[0],n=e[1],i=t,r=n;switch(e.length){case 3:r=e[2];break;case 4:i=e[2],r=e[3]}o(this,t,n,i,r)},setBoundary:function(e,t,n){this["set"+(n?"Start":"End")](e,t)},setStartBefore:s(!0,!0),setStartAfter:s(!1,!0),setEndBefore:s(!0,!1),setEndAfter:s(!1,!1),collapse:function(e){E(this),e?o(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):o(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(e){m(e,!0),o(this,e,0,e,U(e))},selectNode:function(e){m(e,!1),v(e,G);var t=i(e),n=r(e);o(this,t.node,t.offset,n.node,n.offset)},extractContents:_(d,o),deleteContents:_(f,o),canSurroundContents:function(){E(this),y(this.startContainer),y(this.endContainer);var e=new p(this,(!0)),n=e._first&&t(e._first,this)||e._last&&t(e._last,this);return e.detach(),!n},splitBoundaries:function(){b(this)},splitBoundariesPreservingPositions:function(e){b(this,e)},normalizeBoundaries:function(){E(this);var e,t=this.startContainer,n=this.startOffset,i=this.endContainer,r=this.endOffset,s=function(e){var t=e.nextSibling;t&&t.nodeType==e.nodeType&&(i=e,r=e.length,e.appendData(t.data),Q(t))},a=function(e){var o=e.previousSibling;if(o&&o.nodeType==e.nodeType){t=e;var s=e.length;if(n=o.length,e.insertData(0,o.data),Q(o),t==i)r+=n,i=t;else if(i==e.parentNode){var a=L(e);r==a?(i=e,r=s):r>a&&r--}}},c=!0;if(M(i))r==i.length?s(i):0==r&&(e=i.previousSibling,e&&e.nodeType==i.nodeType&&(r=e.length,t==i&&(c=!1),e.appendData(i.data),Q(i),i=e));else{if(r>0){var l=i.childNodes[r-1];l&&M(l)&&s(l)}c=!this.collapsed}if(c){if(M(t))0==n?a(t):n==t.length&&(e=t.nextSibling,e&&e.nodeType==t.nodeType&&(i==e&&(i=t,r+=t.length),t.appendData(e.data),Q(e)));else if(n<t.childNodes.length){var f=t.childNodes[n];f&&M(f)&&a(f)}}else t=i,n=r;o(this,t,n,i,r)},collapseToPoint:function(e,t){m(e,!0),C(e,t),this.setStartAndEnd(e,t)}}),A(n)}function D(e){e.collapsed=e.startContainer===e.endContainer&&e.startOffset===e.endOffset,e.commonAncestorContainer=e.collapsed?e.startContainer:H.getCommonAncestor(e.startContainer,e.endContainer)}function I(e,t,n,o,i){e.startContainer=t,e.startOffset=n,e.endContainer=o,e.endOffset=i,e.document=H.getDocument(t),D(e)}function P(e){this.startContainer=e,this.startOffset=0,this.endContainer=e,this.endOffset=0,this.document=e,D(this)}var H=e.dom,B=e.util,$=H.DomPosition,k=e.DOMException,M=H.isCharacterDataNode,L=H.getNodeIndex,j=H.isOrIsAncestorOf,W=H.getDocument,F=H.comparePoints,z=H.splitDataNode,Y=H.getClosestAncestorIn,U=H.getNodeLength,V=H.arrayContains,q=H.getRootContainer,X=e.features.crashyTextNodes,Q=H.removeNode;p.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null,this._next=this._first},hasNext:function(){return!!this._next},next:function(){var e=this._current=this._next;return e&&(this._next=e!==this._last?e.nextSibling:null,M(e)&&this.clonePartiallySelectedTextNodes&&(e===this.ec&&(e=e.cloneNode(!0)).deleteData(this.eo,e.length-this.eo),this._current===this.sc&&(e=e.cloneNode(!0)).deleteData(0,this.so))),e},remove:function(){var e,t,n=this._current;!M(n)||n!==this.sc&&n!==this.ec?n.parentNode&&Q(n):(e=n===this.sc?this.so:0,t=n===this.ec?this.eo:n.length,e!=t&&n.deleteData(e,t-e))},isPartiallySelectedSubtree:function(){var e=this._current;return t(e,this.range)},getSubtreeIterator:function(){var e;if(this.isSingleCharacterDataNode)e=this.range.cloneRange(),e.collapse(!1);else{e=new P(n(this.range));var t=this._current,o=t,i=0,r=t,s=U(t);j(t,this.sc)&&(o=this.sc,i=this.so),j(t,this.ec)&&(r=this.ec,s=this.eo),I(e,o,i,r,s)}return new p(e,this.clonePartiallySelectedTextNodes)},detach:function(){this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};var G=[1,3,4,5,7,8,10],K=[2,9,11],J=[5,6,10,12],Z=[1,3,4,5,7,8,10,11],ee=[1,3,4,5,7,8],te=g([9,11]),ne=g(J),oe=g([6,10,12]),ie=document.createElement("style"),re=!1;try{ie.innerHTML="<b>x</b>",re=3==ie.firstChild.nodeType}catch(e){}e.features.htmlParsingConforms=re;var se=re?function(e){var t=this.startContainer,n=W(t);if(!t)throw new k("INVALID_STATE_ERR");var o=null;return 1==t.nodeType?o=t:M(t)&&(o=H.parentElement(t)),o=null===o||"HTML"==o.nodeName&&H.isHtmlNamespace(W(o).documentElement)&&H.isHtmlNamespace(o)?n.createElement("body"):o.cloneNode(!1),o.innerHTML=e,H.fragmentFromNodeChildren(o)}:function(e){var t=n(this),o=t.createElement("body");return o.innerHTML=e,H.fragmentFromNodeChildren(o)},ae=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],ce=0,le=1,fe=2,de=3,ue=0,he=1,pe=2,ge=3;B.extend(e.rangePrototype,{compareBoundaryPoints:function(e,t){E(this),w(this.startContainer,t.startContainer);var n,o,i,r,s=e==de||e==ce?"start":"end",a=e==le||e==ce?"start":"end";return n=this[s+"Container"],o=this[s+"Offset"],i=t[a+"Container"],r=t[a+"Offset"],F(n,o,i,r)},insertNode:function(e){if(E(this),v(e,Z),y(this.startContainer),j(e,this.startContainer))throw new k("HIERARCHY_REQUEST_ERR");var t=s(e,this.startContainer,this.startOffset);this.setStartBefore(t)},cloneContents:function(){E(this);var e,t;if(this.collapsed)return n(this).createDocumentFragment();if(this.startContainer===this.endContainer&&M(this.startContainer))return e=this.startContainer.cloneNode(!0),e.data=e.data.slice(this.startOffset,this.endOffset),t=n(this).createDocumentFragment(),t.appendChild(e),t;var o=new p(this,(!0));return e=c(o),o.detach(),e},canSurroundContents:function(){E(this),y(this.startContainer),y(this.endContainer);var e=new p(this,(!0)),n=e._first&&t(e._first,this)||e._last&&t(e._last,this);return e.detach(),!n},surroundContents:function(e){if(v(e,ee),!this.canSurroundContents())throw new k("INVALID_STATE_ERR");var t=this.extractContents();if(e.hasChildNodes())for(;e.lastChild;)e.removeChild(e.lastChild);s(e,this.startContainer,this.startOffset),e.appendChild(t),this.selectNode(e)},cloneRange:function(){E(this);for(var e,t=new P(n(this)),o=ae.length;o--;)e=ae[o],t[e]=this[e];return t},toString:function(){E(this);var e=this.startContainer;if(e===this.endContainer&&M(e))return 3==e.nodeType||4==e.nodeType?e.data.slice(this.startOffset,this.endOffset):"";var t=[],n=new p(this,(!0));return l(n,function(e){3!=e.nodeType&&4!=e.nodeType||t.push(e.data)}),n.detach(),t.join("")},compareNode:function(e){E(this);var t=e.parentNode,n=L(e);if(!t)throw new k("NOT_FOUND_ERR");var o=this.comparePoint(t,n),i=this.comparePoint(t,n+1);return o<0?i>0?pe:ue:i>0?he:ge},comparePoint:function(e,t){return E(this),R(e,"HIERARCHY_REQUEST_ERR"),w(e,this.startContainer),F(e,t,this.startContainer,this.startOffset)<0?-1:F(e,t,this.endContainer,this.endOffset)>0?1:0},createContextualFragment:se,toHtml:function(){return S(this)},intersectsNode:function(e,t){if(E(this),q(e)!=o(this))return!1;var n=e.parentNode,i=L(e);if(!n)return!0;var r=F(n,i,this.endContainer,this.endOffset),s=F(n,i+1,this.startContainer,this.startOffset);return t?r<=0&&s>=0:r<0&&s>0},isPointInRange:function(e,t){return E(this),R(e,"HIERARCHY_REQUEST_ERR"),w(e,this.startContainer),F(e,t,this.startContainer,this.startOffset)>=0&&F(e,t,this.endContainer,this.endOffset)<=0},intersectsRange:function(e){return a(this,e,!1)},intersectsOrTouchesRange:function(e){return a(this,e,!0)},intersection:function(e){if(this.intersectsRange(e)){var t=F(this.startContainer,this.startOffset,e.startContainer,e.startOffset),n=F(this.endContainer,this.endOffset,e.endContainer,e.endOffset),o=this.cloneRange();return t==-1&&o.setStart(e.startContainer,e.startOffset),1==n&&o.setEnd(e.endContainer,e.endOffset),o}return null},union:function(e){if(this.intersectsOrTouchesRange(e)){var t=this.cloneRange();return F(e.startContainer,e.startOffset,this.startContainer,this.startOffset)==-1&&t.setStart(e.startContainer,e.startOffset),1==F(e.endContainer,e.endOffset,this.endContainer,this.endOffset)&&t.setEnd(e.endContainer,e.endOffset),t}throw new k("Ranges do not intersect")},containsNode:function(e,t){return t?this.intersectsNode(e,!1):this.compareNode(e)==ge},containsNodeContents:function(e){return this.comparePoint(e,0)>=0&&this.comparePoint(e,U(e))<=0},containsRange:function(e){var t=this.intersection(e);return null!==t&&e.equals(t)},containsNodeText:function(e){var t=this.cloneRange();t.selectNode(e);var n=t.getNodes([3]);if(n.length>0){t.setStart(n[0],0);var o=n.pop();return t.setEnd(o,o.length),this.containsRange(t)}return this.containsNodeContents(e)},getNodes:function(e,t){return E(this),u(this,e,t)},getDocument:function(){return n(this)},collapseBefore:function(e){this.setEndBefore(e),this.collapse(!1)},collapseAfter:function(e){this.setStartAfter(e),this.collapse(!0)},getBookmark:function(t){var o=n(this),i=e.createRange(o);t=t||H.getBody(o),i.selectNodeContents(t);var r=this.intersection(i),s=0,a=0;return r&&(i.setEnd(r.startContainer,r.startOffset),s=i.toString().length,a=s+r.toString().length),{start:s,end:a,containerNode:t}},moveToBookmark:function(e){var t=e.containerNode,n=0;this.setStart(t,0),this.collapse(!0);for(var o,i,r,s,a=[t],c=!1,l=!1;!l&&(o=a.pop());)if(3==o.nodeType)i=n+o.length,!c&&e.start>=n&&e.start<=i&&(this.setStart(o,e.start-n),c=!0),c&&e.end>=n&&e.end<=i&&(this.setEnd(o,e.end-n),l=!0),n=i;else for(s=o.childNodes,r=s.length;r--;)a.push(s[r])},getName:function(){return"DomRange"},equals:function(e){return P.rangesEqual(this,e)},isValid:function(){return T(this)},inspect:function(){return h(this)},detach:function(){}}),x(P,I),B.extend(P,{rangeProperties:ae,RangeIterator:p,copyComparisonConstants:A,createPrototypeRange:x,inspect:h,toHtml:S,getRangeDocument:n,rangesEqual:function(e,t){return e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset}}),e.DomRange=P}),P.createCoreModule("WrappedRange",["DomRange"],function(e,t){var n,o,i=e.dom,r=e.util,s=i.DomPosition,a=e.DomRange,c=i.getBody,l=i.getContentDocument,f=i.isCharacterDataNode;if(e.features.implementsDomRange&&!function(){function o(e){for(var t,n=u.length;n--;)t=u[n],e[t]=e.nativeRange[t];e.collapsed=e.startContainer===e.endContainer&&e.startOffset===e.endOffset}function s(e,t,n,o,i){var r=e.startContainer!==t||e.startOffset!=n,s=e.endContainer!==o||e.endOffset!=i,a=!e.equals(e.nativeRange);(r||s||a)&&(e.setEnd(o,i),e.setStart(t,n))}var f,d,u=a.rangeProperties;n=function(e){if(!e)throw t.createError("WrappedRange: Range must be specified");this.nativeRange=e,o(this)},a.createPrototypeRange(n,s),f=n.prototype,f.selectNode=function(e){this.nativeRange.selectNode(e),o(this)},f.cloneContents=function(){return this.nativeRange.cloneContents()},f.surroundContents=function(e){this.nativeRange.surroundContents(e),o(this)},f.collapse=function(e){this.nativeRange.collapse(e),o(this)},f.cloneRange=function(){return new n(this.nativeRange.cloneRange())},f.refresh=function(){o(this)},f.toString=function(){return this.nativeRange.toString()};var h=document.createTextNode("test");c(document).appendChild(h);var p=document.createRange();p.setStart(h,0),p.setEnd(h,0);try{p.setStart(h,1),f.setStart=function(e,t){this.nativeRange.setStart(e,t),o(this)},f.setEnd=function(e,t){this.nativeRange.setEnd(e,t),o(this)},d=function(e){return function(t){this.nativeRange[e](t),o(this)}}}catch(e){f.setStart=function(e,t){try{this.nativeRange.setStart(e,t)}catch(n){this.nativeRange.setEnd(e,t),this.nativeRange.setStart(e,t)}o(this)},f.setEnd=function(e,t){try{this.nativeRange.setEnd(e,t)}catch(n){this.nativeRange.setStart(e,t),this.nativeRange.setEnd(e,t)}o(this)},d=function(e,t){return function(n){try{this.nativeRange[e](n)}catch(o){this.nativeRange[t](n),this.nativeRange[e](n)}o(this)}}}f.setStartBefore=d("setStartBefore","setEndBefore"),f.setStartAfter=d("setStartAfter","setEndAfter"),f.setEndBefore=d("setEndBefore","setStartBefore"),f.setEndAfter=d("setEndAfter","setStartAfter"),f.selectNodeContents=function(e){this.setStartAndEnd(e,0,i.getNodeLength(e))},p.selectNodeContents(h),p.setEnd(h,3);var g=document.createRange();g.selectNodeContents(h),g.setEnd(h,4),g.setStart(h,2),p.compareBoundaryPoints(p.START_TO_END,g)==-1&&1==p.compareBoundaryPoints(p.END_TO_START,g)?f.compareBoundaryPoints=function(e,t){return t=t.nativeRange||t,e==t.START_TO_END?e=t.END_TO_START:e==t.END_TO_START&&(e=t.START_TO_END),this.nativeRange.compareBoundaryPoints(e,t)}:f.compareBoundaryPoints=function(e,t){return this.nativeRange.compareBoundaryPoints(e,t.nativeRange||t)};var m=document.createElement("div");m.innerHTML="123";var v=m.firstChild,C=c(document);C.appendChild(m),p.setStart(v,1),p.setEnd(v,2),p.deleteContents(),"13"==v.data&&(f.deleteContents=function(){this.nativeRange.deleteContents(),o(this)},f.extractContents=function(){var e=this.nativeRange.extractContents();return o(this),e}),C.removeChild(m),C=null,r.isHostMethod(p,"createContextualFragment")&&(f.createContextualFragment=function(e){return this.nativeRange.createContextualFragment(e)}),c(document).removeChild(h),f.getName=function(){return"WrappedRange"},e.WrappedRange=n,e.createNativeRange=function(e){return e=l(e,t,"createNativeRange"),e.createRange()}}(),e.features.implementsTextRange){var d=function(e){var t=e.parentElement(),n=e.duplicate();n.collapse(!0);var o=n.parentElement();n=e.duplicate(),n.collapse(!1);var r=n.parentElement(),s=o==r?o:i.getCommonAncestor(o,r);return s==t?s:i.getCommonAncestor(t,s)},u=function(e){return 0==e.compareEndPoints("StartToEnd",e)},h=function(e,t,n,o,r){var a=e.duplicate();a.collapse(n);var c=a.parentElement();if(i.isOrIsAncestorOf(t,c)||(c=t),!c.canHaveHTML){var l=new s(c.parentNode,i.getNodeIndex(c));return{boundaryPosition:l,nodeInfo:{nodeIndex:l.offset,containerElement:l.node}}}var d=i.getDocument(c).createElement("span");d.parentNode&&i.removeNode(d);for(var u,h,p,g,m,v=n?"StartToStart":"StartToEnd",C=r&&r.containerElement==c?r.nodeIndex:0,w=c.childNodes.length,y=w,R=y;;){if(R==w?c.appendChild(d):c.insertBefore(d,c.childNodes[R]),a.moveToElementText(d),u=a.compareEndPoints(v,e),0==u||C==y)break;if(u==-1){if(y==C+1)break;C=R}else y=y==C+1?C:R;R=Math.floor((C+y)/2),c.removeChild(d)}if(m=d.nextSibling,u==-1&&m&&f(m)){a.setEndPoint(n?"EndToStart":"EndToEnd",e);var N;if(/[\r\n]/.test(m.data)){var T=a.duplicate(),E=T.text.replace(/\r\n/g,"\r").length;for(N=T.moveStart("character",E);(u=T.compareEndPoints("StartToEnd",T))==-1;)N++,T.moveStart("character",1)}else N=a.text.length;g=new s(m,N)}else h=(o||!n)&&d.previousSibling,p=(o||n)&&d.nextSibling,g=p&&f(p)?new s(p,0):h&&f(h)?new s(h,h.data.length):new s(c,i.getNodeIndex(d));return i.removeNode(d),{boundaryPosition:g,nodeInfo:{nodeIndex:R,containerElement:c}}},p=function(e,t){var n,o,r,s,a=e.offset,l=i.getDocument(e.node),d=c(l).createTextRange(),u=f(e.node);return u?(n=e.node,o=n.parentNode):(s=e.node.childNodes,n=a<s.length?s[a]:null,o=e.node),r=l.createElement("span"),r.innerHTML="&#feff;",n?o.insertBefore(r,n):o.appendChild(r),d.moveToElementText(r),d.collapse(!t),o.removeChild(r),u&&d[t?"moveStart":"moveEnd"]("character",a),d};o=function(e){this.textRange=e,this.refresh()},o.prototype=new a(document),o.prototype.refresh=function(){var e,t,n,o=d(this.textRange);u(this.textRange)?t=e=h(this.textRange,o,!0,!0).boundaryPosition:(n=h(this.textRange,o,!0,!1),e=n.boundaryPosition,t=h(this.textRange,o,!1,!1,n.nodeInfo).boundaryPosition),this.setStart(e.node,e.offset),this.setEnd(t.node,t.offset)},o.prototype.getName=function(){return"WrappedTextRange"},a.copyComparisonConstants(o);var g=function(e){if(e.collapsed)return p(new s(e.startContainer,e.startOffset),!0);var t=p(new s(e.startContainer,e.startOffset),!0),n=p(new s(e.endContainer,e.endOffset),!1),o=c(a.getRangeDocument(e)).createTextRange();return o.setEndPoint("StartToStart",t),o.setEndPoint("EndToEnd",n),o};if(o.rangeToTextRange=g,o.prototype.toTextRange=function(){return g(this)},e.WrappedTextRange=o,!e.features.implementsDomRange||e.config.preferTextRange){var m=function(e){return e("return this;")()}(Function);"undefined"==typeof m.Range&&(m.Range=o),e.createNativeRange=function(e){return e=l(e,t,"createNativeRange"),c(e).createTextRange()},e.WrappedRange=o}}e.createRange=function(n){return n=l(n,t,"createRange"),new e.WrappedRange(e.createNativeRange(n))},e.createRangyRange=function(e){return e=l(e,t,"createRangyRange"),new a(e)},r.createAliasForDeprecatedMethod(e,"createIframeRange","createRange"),r.createAliasForDeprecatedMethod(e,"createIframeRangyRange","createRangyRange"),e.addShimListener(function(t){var n=t.document;"undefined"==typeof n.createRange&&(n.createRange=function(){return e.createRange(n)}),n=t=null})}),P.createCoreModule("WrappedSelection",["DomRange","WrappedRange"],function(e,t){function n(e){return"string"==typeof e?/^backward(s)?$/i.test(e):!!e}function o(e,n){if(e){if(A.isWindow(e))return e;if(e instanceof v)return e.win;var o=A.getContentDocument(e,t,n);return A.getWindow(o)}return window}function i(e){return o(e,"getWinSelection").getSelection()}function r(e){return o(e,"getDocSelection").document.selection}function s(e){var t=!1;return e.anchorNode&&(t=1==A.comparePoints(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset)),t}function a(e,t,n){var o=n?"end":"start",i=n?"start":"end";e.anchorNode=t[o+"Container"],e.anchorOffset=t[o+"Offset"],e.focusNode=t[i+"Container"],e.focusOffset=t[i+"Offset"]}function c(e){var t=e.nativeSelection;e.anchorNode=t.anchorNode,e.anchorOffset=t.anchorOffset,e.focusNode=t.focusNode,e.focusOffset=t.focusOffset}function l(e){e.anchorNode=e.focusNode=null,e.anchorOffset=e.focusOffset=0,e.rangeCount=0,e.isCollapsed=!0,e._ranges.length=0}function f(t){var n;return t instanceof D?(n=e.createNativeRange(t.getDocument()),n.setEnd(t.endContainer,t.endOffset),n.setStart(t.startContainer,t.startOffset)):t instanceof I?n=t.nativeRange:B.implementsDomRange&&t instanceof A.getWindow(t.startContainer).Range&&(n=t),n}function d(e){if(!e.length||1!=e[0].nodeType)return!1;for(var t=1,n=e.length;t<n;++t)if(!A.isAncestorOf(e[0],e[t]))return!1;return!0}function u(e){var n=e.getNodes();if(!d(n))throw t.createError("getSingleElementFromRange: range "+e.inspect()+" did not consist of a single element");return n[0]}function h(e){return!!e&&"undefined"!=typeof e.text}function p(e,t){var n=new I(t);e._ranges=[n],a(e,n,!1),e.rangeCount=1,e.isCollapsed=n.collapsed}function g(t){if(t._ranges.length=0,"None"==t.docSelection.type)l(t);else{var n=t.docSelection.createRange();if(h(n))p(t,n);else{t.rangeCount=n.length;for(var o,i=k(n.item(0)),r=0;r<t.rangeCount;++r)o=e.createRange(i),o.selectNode(n.item(r)),t._ranges.push(o);t.isCollapsed=1==t.rangeCount&&t._ranges[0].collapsed,a(t,t._ranges[t.rangeCount-1],!1)}}}function m(e,n){for(var o=e.docSelection.createRange(),i=u(n),r=k(o.item(0)),s=M(r).createControlRange(),a=0,c=o.length;a<c;++a)s.add(o.item(a));try{s.add(i)}catch(e){throw t.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}s.select(),g(e)}function v(e,t,n){this.nativeSelection=e,this.docSelection=t,this._ranges=[],this.win=n,this.refresh()}function C(e){e.win=e.anchorNode=e.focusNode=e._ranges=null,e.rangeCount=e.anchorOffset=e.focusOffset=0,e.detached=!0}function w(e,t){for(var n,o,i=te.length;i--;)if(n=te[i],o=n.selection,"deleteAll"==t)C(o);else if(n.win==e)return"delete"==t?(te.splice(i,1),!0):o;return"deleteAll"==t&&(te.length=0),null}function y(e,n){for(var o,i=k(n[0].startContainer),r=M(i).createControlRange(),s=0,a=n.length;s<a;++s){o=u(n[s]);try{r.add(o)}catch(e){throw t.createError("setRanges(): Element within one of the specified Ranges could not be added to control selection (does it have layout?)")}}r.select(),g(e)}function R(e,t){if(e.win.document!=k(t))throw new P("WRONG_DOCUMENT_ERR")}function N(t){return function(n,o){var i;this.rangeCount?(i=this.getRangeAt(0),i["set"+(t?"Start":"End")](n,o)):(i=e.createRange(this.win.document),i.setStartAndEnd(n,o)),this.setSingleRange(i,this.isBackward())}}function T(e){var t=[],n=new H(e.anchorNode,e.anchorOffset),o=new H(e.focusNode,e.focusOffset),i="function"==typeof e.getName?e.getName():"Selection";if("undefined"!=typeof e.rangeCount)for(var r=0,s=e.rangeCount;r<s;++r)t[r]=D.inspect(e.getRangeAt(r));return"["+i+"(Ranges: "+t.join(", ")+")(anchor: "+n.inspect()+", focus: "+o.inspect()+"]"}e.config.checkSelectionRanges=!0;var E,b,S="boolean",O="number",A=e.dom,_=e.util,x=_.isHostMethod,D=e.DomRange,I=e.WrappedRange,P=e.DOMException,H=A.DomPosition,B=e.features,$="Control",k=A.getDocument,M=A.getBody,L=D.rangesEqual,j=x(window,"getSelection"),W=_.isHostObject(document,"selection");B.implementsWinGetSelection=j,B.implementsDocSelection=W;var F=W&&(!j||e.config.preferTextRange);if(F)E=r,e.isSelectionValid=function(e){var t=o(e,"isSelectionValid").document,n=t.selection;return"None"!=n.type||k(n.createRange().parentElement())==t};else{if(!j)return t.fail("Neither document.selection or window.getSelection() detected."),!1;E=i,e.isSelectionValid=function(){return!0}}e.getNativeSelection=E;var z=E();if(!z)return t.fail("Native selection was null (possibly issue 138?)"),!1;var Y=e.createNativeRange(document),U=M(document),V=_.areHostProperties(z,["anchorNode","focusNode","anchorOffset","focusOffset"]);B.selectionHasAnchorAndFocus=V;var q=x(z,"extend");B.selectionHasExtend=q;var X=typeof z.rangeCount==O;B.selectionHasRangeCount=X;var Q=!1,G=!0,K=q?function(t,n){var o=D.getRangeDocument(n),i=e.createRange(o);i.collapseToPoint(n.endContainer,n.endOffset),t.addRange(f(i)),t.extend(n.startContainer,n.startOffset)}:null;_.areHostMethods(z,["addRange","getRangeAt","removeAllRanges"])&&typeof z.rangeCount==O&&B.implementsDomRange&&!function(){var t=window.getSelection();if(t){for(var n=t.rangeCount,o=n>1,i=[],r=s(t),a=0;a<n;++a)i[a]=t.getRangeAt(a);var c=A.createTestElement(document,"",!1),l=c.appendChild(document.createTextNode("\xa0\xa0\xa0")),f=document.createRange();if(f.setStart(l,1),f.collapse(!0),t.removeAllRanges(),t.addRange(f),G=1==t.rangeCount,t.removeAllRanges(),!o){var d=window.navigator.appVersion.match(/Chrome\/(.*?) /);if(d&&parseInt(d[1])>=36)Q=!1;else{var u=f.cloneRange();f.setStart(l,0),u.setEnd(l,3),u.setStart(l,2),t.addRange(f),t.addRange(u),Q=2==t.rangeCount}}for(A.removeNode(c),t.removeAllRanges(),a=0;a<n;++a)0==a&&r?K?K(t,i[a]):(e.warn("Rangy initialization: original selection was backwards but selection has been restored forwards because the browser does not support Selection.extend"),t.addRange(i[a])):t.addRange(i[a])}}(),B.selectionSupportsMultipleRanges=Q,B.collapsedNonEditableSelectionsSupported=G;var J,Z=!1;U&&x(U,"createControlRange")&&(J=U.createControlRange(),_.areHostProperties(J,["item","add"])&&(Z=!0)),B.implementsControlRange=Z,b=V?function(e){return e.anchorNode===e.focusNode&&e.anchorOffset===e.focusOffset}:function(e){return!!e.rangeCount&&e.getRangeAt(e.rangeCount-1).collapsed};var ee;x(z,"getRangeAt")?ee=function(e,t){try{return e.getRangeAt(t)}catch(e){return null}}:V&&(ee=function(t){var n=k(t.anchorNode),o=e.createRange(n);return o.setStartAndEnd(t.anchorNode,t.anchorOffset,t.focusNode,t.focusOffset),o.collapsed!==this.isCollapsed&&o.setStartAndEnd(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset),o}),v.prototype=e.selectionPrototype;var te=[],ne=function(e){if(e&&e instanceof v)return e.refresh(),e;e=o(e,"getNativeSelection");var t=w(e),n=E(e),i=W?r(e):null;return t?(t.nativeSelection=n,t.docSelection=i,t.refresh()):(t=new v(n,i,e),te.push({win:e,selection:t})),t};e.getSelection=ne,_.createAliasForDeprecatedMethod(e,"getIframeSelection","getSelection");var oe=v.prototype;if(!F&&V&&_.areHostMethods(z,["removeAllRanges","addRange"])){oe.removeAllRanges=function(){this.nativeSelection.removeAllRanges(),l(this)};var ie=function(e,t){K(e.nativeSelection,t),e.refresh()};X?oe.addRange=function(t,o){if(Z&&W&&this.docSelection.type==$)m(this,t);else if(n(o)&&q)ie(this,t);else{var i;Q?i=this.rangeCount:(this.removeAllRanges(),i=0);var r=f(t).cloneRange();try{this.nativeSelection.addRange(r)}catch(e){}if(this.rangeCount=this.nativeSelection.rangeCount,this.rangeCount==i+1){if(e.config.checkSelectionRanges){var s=ee(this.nativeSelection,this.rangeCount-1);s&&!L(s,t)&&(t=new I(s))}this._ranges[this.rangeCount-1]=t,a(this,t,ae(this.nativeSelection)),this.isCollapsed=b(this)}else this.refresh()}}:oe.addRange=function(e,t){n(t)&&q?ie(this,e):(this.nativeSelection.addRange(f(e)),this.refresh())},oe.setRanges=function(e){if(Z&&W&&e.length>1)y(this,e);else{this.removeAllRanges();for(var t=0,n=e.length;t<n;++t)this.addRange(e[t])}}}else{if(!(x(z,"empty")&&x(Y,"select")&&Z&&F))return t.fail("No means of selecting a Range or TextRange was found"),!1;oe.removeAllRanges=function(){try{if(this.docSelection.empty(),"None"!=this.docSelection.type){var e;if(this.anchorNode)e=k(this.anchorNode);else if(this.docSelection.type==$){var t=this.docSelection.createRange();t.length&&(e=k(t.item(0)))}if(e){var n=M(e).createTextRange();n.select(),this.docSelection.empty()}}}catch(e){}l(this)},oe.addRange=function(t){this.docSelection.type==$?m(this,t):(e.WrappedTextRange.rangeToTextRange(t).select(),this._ranges[0]=t,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,a(this,t,!1))},oe.setRanges=function(e){this.removeAllRanges();var t=e.length;t>1?y(this,e):t&&this.addRange(e[0])}}oe.getRangeAt=function(e){if(e<0||e>=this.rangeCount)throw new P("INDEX_SIZE_ERR");return this._ranges[e].cloneRange()};var re;if(F)re=function(t){var n;e.isSelectionValid(t.win)?n=t.docSelection.createRange():(n=M(t.win.document).createTextRange(),n.collapse(!0)),t.docSelection.type==$?g(t):h(n)?p(t,n):l(t)};else if(x(z,"getRangeAt")&&typeof z.rangeCount==O)re=function(t){if(Z&&W&&t.docSelection.type==$)g(t);else if(t._ranges.length=t.rangeCount=t.nativeSelection.rangeCount,t.rangeCount){for(var n=0,o=t.rangeCount;n<o;++n)t._ranges[n]=new e.WrappedRange(t.nativeSelection.getRangeAt(n));a(t,t._ranges[t.rangeCount-1],ae(t.nativeSelection)),t.isCollapsed=b(t)}else l(t)};else{if(!V||typeof z.isCollapsed!=S||typeof Y.collapsed!=S||!B.implementsDomRange)return t.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;re=function(e){var t,n=e.nativeSelection;n.anchorNode?(t=ee(n,0),e._ranges=[t],e.rangeCount=1,c(e),e.isCollapsed=b(e)):l(e)}}oe.refresh=function(e){var t=e?this._ranges.slice(0):null,n=this.anchorNode,o=this.anchorOffset;if(re(this),e){var i=t.length;if(i!=this._ranges.length)return!0;if(this.anchorNode!=n||this.anchorOffset!=o)return!0;for(;i--;)if(!L(t[i],this._ranges[i]))return!0;return!1}};var se=function(e,t){var n=e.getAllRanges();e.removeAllRanges();for(var o=0,i=n.length;o<i;++o)L(t,n[o])||e.addRange(n[o]);e.rangeCount||l(e)};Z&&W?oe.removeRange=function(e){if(this.docSelection.type==$){for(var t,n=this.docSelection.createRange(),o=u(e),i=k(n.item(0)),r=M(i).createControlRange(),s=!1,a=0,c=n.length;a<c;++a)t=n.item(a),t!==o||s?r.add(n.item(a)):s=!0;r.select(),g(this)}else se(this,e)}:oe.removeRange=function(e){se(this,e)};var ae;!F&&V&&B.implementsDomRange?(ae=s,oe.isBackward=function(){return ae(this)}):ae=oe.isBackward=function(){return!1},oe.isBackwards=oe.isBackward,oe.toString=function(){for(var e=[],t=0,n=this.rangeCount;t<n;++t)e[t]=""+this._ranges[t];return e.join("")},oe.collapse=function(t,n){R(this,t);var o=e.createRange(t);o.collapseToPoint(t,n),this.setSingleRange(o),this.isCollapsed=!0},oe.collapseToStart=function(){if(!this.rangeCount)throw new P("INVALID_STATE_ERR");var e=this._ranges[0];this.collapse(e.startContainer,e.startOffset)},oe.collapseToEnd=function(){if(!this.rangeCount)throw new P("INVALID_STATE_ERR");var e=this._ranges[this.rangeCount-1];this.collapse(e.endContainer,e.endOffset)},oe.selectAllChildren=function(t){R(this,t);var n=e.createRange(t);n.selectNodeContents(t),this.setSingleRange(n)},oe.deleteFromDocument=function(){if(Z&&W&&this.docSelection.type==$){for(var e,t=this.docSelection.createRange();t.length;)e=t.item(0),t.remove(e),A.removeNode(e);this.refresh()}else if(this.rangeCount){var n=this.getAllRanges();if(n.length){this.removeAllRanges();for(var o=0,i=n.length;o<i;++o)n[o].deleteContents();this.addRange(n[i-1])}}},oe.eachRange=function(e,t){for(var n=0,o=this._ranges.length;n<o;++n)if(e(this.getRangeAt(n)))return t},oe.getAllRanges=function(){var e=[];return this.eachRange(function(t){e.push(t)}),e},oe.setSingleRange=function(e,t){this.removeAllRanges(),this.addRange(e,t)},oe.callMethodOnEachRange=function(e,t){
var n=[];return this.eachRange(function(o){n.push(o[e].apply(o,t||[]))}),n},oe.setStart=N(!0),oe.setEnd=N(!1),e.rangePrototype.select=function(e){ne(this.getDocument()).setSingleRange(this,e)},oe.changeEachRange=function(e){var t=[],n=this.isBackward();this.eachRange(function(n){e(n),t.push(n)}),this.removeAllRanges(),n&&1==t.length?this.addRange(t[0],"backward"):this.setRanges(t)},oe.containsNode=function(e,t){return this.eachRange(function(n){return n.containsNode(e,t)},!0)||!1},oe.getBookmark=function(e){return{backward:this.isBackward(),rangeBookmarks:this.callMethodOnEachRange("getBookmark",[e])}},oe.moveToBookmark=function(t){for(var n,o,i=[],r=0;n=t.rangeBookmarks[r++];)o=e.createRange(this.win),o.moveToBookmark(n),i.push(o);t.backward?this.setSingleRange(i[0],"backward"):this.setRanges(i)},oe.saveRanges=function(){return{backward:this.isBackward(),ranges:this.callMethodOnEachRange("cloneRange")}},oe.restoreRanges=function(e){this.removeAllRanges();for(var t,n=0;t=e.ranges[n];++n)this.addRange(t,e.backward&&0==n)},oe.toHtml=function(){var e=[];return this.eachRange(function(t){e.push(D.toHtml(t))}),e.join("")},B.implementsTextRange&&(oe.getNativeTextRange=function(){var n;if(n=this.docSelection){var o=n.createRange();if(h(o))return o;throw t.createError("getNativeTextRange: selection is a control selection")}if(this.rangeCount>0)return e.WrappedTextRange.rangeToTextRange(this.getRangeAt(0));throw t.createError("getNativeTextRange: selection contains no range")}),oe.getName=function(){return"WrappedSelection"},oe.inspect=function(){return T(this)},oe.detach=function(){w(this.win,"delete"),C(this)},v.detachAll=function(){w(null,"deleteAll")},v.inspect=T,v.isDirectionBackward=n,e.Selection=v,e.selectionPrototype=oe,e.addShimListener(function(e){"undefined"==typeof e.getSelection&&(e.getSelection=function(){return ne(e)}),e=null})});var M=!1,L=function(){M||(M=!0,!P.initialized&&P.config.autoInitialize&&d())};return D&&("complete"==document.readyState?L():(e(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",L,!1),B(window,"load",L))),P},this),function(e,t){"function"==typeof define&&define.amd?define(["./rangy-core"],e):"undefined"!=typeof module&&"object"==typeof exports?module.exports=e(require("rangy")):e(t.rangy)}(function(e){return e.createModule("ClassApplier",["WrappedSelection"],function(e,t){function n(e,t){for(var n in e)if(e.hasOwnProperty(n)&&t(n,e[n])===!1)return!1;return!0}function o(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function r(e,t){return!!e&&new RegExp("(?:^|\\s)"+t+"(?:\\s|$)").test(e)}function s(e,t){if("object"==typeof e.classList)return e.classList.contains(t);var n="string"==typeof e.className,o=n?e.className:e.getAttribute("class");return r(o,t)}function a(e,t){if("object"==typeof e.classList)e.classList.add(t);else{var n="string"==typeof e.className,o=n?e.className:e.getAttribute("class");o?r(o,t)||(o+=" "+t):o=t,n?e.className=o:e.setAttribute("class",o)}}function c(e){var t="string"==typeof e.className;return t?e.className:e.getAttribute("class")}function l(e){return e&&e.split(/\s+/).sort().join(" ")}function f(e){return l(c(e))}function d(e,t){return f(e)==f(t)}function u(e,t){for(var n=t.split(/\s+/),i=0,r=n.length;i<r;++i)if(!s(e,o(n[i])))return!1;return!0}function h(e){var t=e.parentNode;return t&&1==t.nodeType&&!/^(textarea|style|script|select|iframe)$/i.test(t.nodeName)}function p(e,t,n,o,i){var r=e.node,s=e.offset,a=r,c=s;r==o&&s>i&&++c,r!=t||s!=n&&s!=n+1||(a=o,c+=i-n),r==t&&s>n+1&&--c,e.node=a,e.offset=c}function g(e,t,n){e.node==t&&e.offset>n&&--e.offset}function m(e,t,n,o){n==-1&&(n=t.childNodes.length);var i=e.parentNode,r=k.getNodeIndex(e);W(o,function(e){p(e,i,r,t,n)}),t.childNodes.length==n?t.appendChild(e):t.insertBefore(e,t.childNodes[n])}function v(e,t){var n=e.parentNode,o=k.getNodeIndex(e);W(t,function(e){g(e,n,o)}),k.removeNode(e)}function C(e,t,n,o,i){for(var r,s=[];r=e.firstChild;)m(r,t,n++,i),s.push(r);return o&&v(e,i),s}function w(e,t){return C(e,e.parentNode,k.getNodeIndex(e),!0,t)}function y(e,t){var n=e.cloneRange();n.selectNodeContents(t);var o=n.intersection(e),i=o?o.toString():"";return""!=i}function R(e){for(var t,n=e.getNodes([3]),o=0;(t=n[o])&&!y(e,t);)++o;for(var i=n.length-1;(t=n[i])&&!y(e,t);)--i;return n.slice(o,i+1)}function N(e,t){if(e.attributes.length!=t.attributes.length)return!1;for(var n,o,i,r=0,s=e.attributes.length;r<s;++r)if(n=e.attributes[r],i=n.name,"class"!=i){if(o=t.attributes.getNamedItem(i),null===n!=(null===o))return!1;if(n.specified!=o.specified)return!1;if(n.specified&&n.nodeValue!==o.nodeValue)return!1}return!0}function T(e,t){for(var n,o=0,i=e.attributes.length;o<i;++o)if(n=e.attributes[o].name,(!t||!L(t,n))&&e.attributes[o].specified&&"class"!=n)return!0;return!1}function E(e){var t;return e&&1==e.nodeType&&((t=e.parentNode)&&9==t.nodeType&&"on"==t.designMode||V(e)&&!V(e.parentNode))}function b(e){return(V(e)||1!=e.nodeType&&V(e.parentNode))&&!E(e)}function S(e){return e&&1==e.nodeType&&!q.test(U(e,"display"))}function O(e){if(0==e.data.length)return!0;if(X.test(e.data))return!1;var t=U(e.parentNode,"whiteSpace");switch(t){case"pre":case"pre-wrap":case"-moz-pre-wrap":return!1;case"pre-line":if(/[\r\n]/.test(e.data))return!1}return S(e.previousSibling)||S(e.nextSibling)}function A(e){var t,n,o=[];for(t=0;n=e[t++];)o.push(new M(n.startContainer,n.startOffset),new M(n.endContainer,n.endOffset));return o}function _(e,t){for(var n,o,i,r=0,s=e.length;r<s;++r)n=e[r],o=t[2*r],i=t[2*r+1],n.setStartAndEnd(o.node,o.offset,i.node,i.offset)}function x(e,t){return k.isCharacterDataNode(e)?0==t?!!e.previousSibling:t!=e.length||!!e.nextSibling:t>0&&t<e.childNodes.length}function D(e,n,o,i){var r,s,a=0==o;if(k.isAncestorOf(n,e))return e;if(k.isCharacterDataNode(n)){var c=k.getNodeIndex(n);if(0==o)o=c;else{if(o!=n.length)throw t.createError("splitNodeAt() should not be called with offset in the middle of a data node ("+o+" in "+n.data);o=c+1}n=n.parentNode}if(x(n,o)){r=n.cloneNode(!1),s=n.parentNode,r.id&&r.removeAttribute("id");for(var l,f=0;l=n.childNodes[o];)m(l,r,f++,i);return m(r,s,k.getNodeIndex(n)+1,i),n==e?r:D(e,s,k.getNodeIndex(r),i)}if(e!=n){r=n.parentNode;var d=k.getNodeIndex(n);return a||d++,D(e,r,d,i)}return e}function I(e,t){return e.namespaceURI==t.namespaceURI&&e.tagName.toLowerCase()==t.tagName.toLowerCase()&&d(e,t)&&N(e,t)&&"inline"==U(e,"display")&&"inline"==U(t,"display")}function P(e){var t=e?"nextSibling":"previousSibling";return function(n,o){var i=n.parentNode,r=n[t];if(r){if(r&&3==r.nodeType)return r}else if(o&&(r=i[t],r&&1==r.nodeType&&I(i,r))){var s=r[e?"firstChild":"lastChild"];if(s&&3==s.nodeType)return s}return null}}function H(e){this.isElementMerge=1==e.nodeType,this.textNodes=[];var t=this.isElementMerge?e.lastChild:e;t&&(this.textNodes[0]=t)}function B(e,t,i){var r,s,a,c,f=this;f.cssClass=f.className=e;var d=null,u={};if("object"==typeof t&&null!==t){for("undefined"!=typeof t.elementTagName&&(t.elementTagName=t.elementTagName.toLowerCase()),i=t.tagNames,d=t.elementProperties,u=t.elementAttributes,s=0;c=K[s++];)t.hasOwnProperty(c)&&(f[c]=t[c]);r=t.normalize}else r=t;f.normalize="undefined"==typeof r||r,f.attrExceptions=[];var h=document.createElement(f.elementTagName);f.elementProperties=f.copyPropertiesToElement(d,h,!0),n(u,function(e,t){f.attrExceptions.push(e),u[e]=""+t}),f.elementAttributes=u,f.elementSortedClassName=f.elementProperties.hasOwnProperty("className")?l(f.elementProperties.className+" "+e):e,f.applyToAnyTagName=!1;var p=typeof i;if("string"==p)"*"==i?f.applyToAnyTagName=!0:f.tagNames=o(i.toLowerCase()).split(/\s*,\s*/);else if("object"==p&&"number"==typeof i.length)for(f.tagNames=[],s=0,a=i.length;s<a;++s)"*"==i[s]?f.applyToAnyTagName=!0:f.tagNames.push(i[s].toLowerCase());else f.tagNames=[f.elementTagName]}function $(e,t,n){return new B(e,t,n)}var k=e.dom,M=k.DomPosition,L=k.arrayContains,j=e.util,W=j.forEach,F="span",z=j.isHostMethod(document,"createElementNS"),Y=function(){function e(e,t,n){return t&&n?" ":""}return function(t,n){if("object"==typeof t.classList)t.classList.remove(n);else{var o="string"==typeof t.className,i=o?t.className:t.getAttribute("class");i=i.replace(new RegExp("(^|\\s)"+n+"(\\s|$)"),e),o?t.className=i:t.setAttribute("class",i)}}}(),U=k.getComputedStyleProperty,V=function(){var e=document.createElement("div");return"boolean"==typeof e.isContentEditable?function(e){return e&&1==e.nodeType&&e.isContentEditable}:function(e){return!(!e||1!=e.nodeType||"false"==e.contentEditable)&&("true"==e.contentEditable||V(e.parentNode))}}(),q=/^inline(-block|-table)?$/i,X=/[^\r\n\t\f \u200B]/,Q=P(!1),G=P(!0);H.prototype={doMerge:function(e){var t=this.textNodes,n=t[0];if(t.length>1){var o,i=k.getNodeIndex(n),r=[],s=0;W(t,function(t,a){o=t.parentNode,a>0&&(o.removeChild(t),o.hasChildNodes()||k.removeNode(o),e&&W(e,function(e){e.node==t&&(e.node=n,e.offset+=s),e.node==o&&e.offset>i&&(--e.offset,e.offset==i+1&&a<len-1&&(e.node=n,e.offset=s))})),r[a]=t.data,s+=t.data.length}),n.data=r.join("")}return n.data},getLength:function(){for(var e=this.textNodes.length,t=0;e--;)t+=this.textNodes[e].length;return t},toString:function(){var e=[];return W(this.textNodes,function(t,n){e[n]="'"+t.data+"'"}),"[Merge("+e.join(",")+")]"}};var K=["elementTagName","ignoreWhiteSpace","applyToEditableOnly","useExistingElements","removeEmptyElements","onElementCreate"],J={};B.prototype={elementTagName:F,elementProperties:{},elementAttributes:{},ignoreWhiteSpace:!0,applyToEditableOnly:!1,useExistingElements:!0,removeEmptyElements:!0,onElementCreate:null,copyPropertiesToElement:function(e,t,n){var o,i,r,s,c,f,d={};for(var u in e)if(e.hasOwnProperty(u))if(s=e[u],c=t[u],"className"==u)a(t,s),a(t,this.className),t[u]=l(t[u]),n&&(d[u]=s);else if("style"==u){i=c,n&&(d[u]=r={});for(o in e[u])e[u].hasOwnProperty(o)&&(i[o]=s[o],n&&(r[o]=i[o]));this.attrExceptions.push(u)}else t[u]=s,n&&(d[u]=t[u],f=J.hasOwnProperty(u)?J[u]:u,this.attrExceptions.push(f));return n?d:""},copyAttributesToElement:function(e,t){for(var n in e)e.hasOwnProperty(n)&&!/^class(?:Name)?$/i.test(n)&&t.setAttribute(n,e[n])},appliesToElement:function(e){return L(this.tagNames,e.tagName.toLowerCase())},getEmptyElements:function(e){var t=this;return e.getNodes([1],function(e){return t.appliesToElement(e)&&!e.hasChildNodes()})},hasClass:function(e){return 1==e.nodeType&&(this.applyToAnyTagName||this.appliesToElement(e))&&s(e,this.className)},getSelfOrAncestorWithClass:function(e){for(;e;){if(this.hasClass(e))return e;e=e.parentNode}return null},isModifiable:function(e){return!this.applyToEditableOnly||b(e)},isIgnorableWhiteSpaceNode:function(e){return this.ignoreWhiteSpace&&e&&3==e.nodeType&&O(e)},postApply:function(e,t,n,o){var r,s,a=e[0],c=e[e.length-1],l=[],f=a,d=c,u=0,h=c.length;W(e,function(e){s=Q(e,!o),s?(r||(r=new H(s),l.push(r)),r.textNodes.push(e),e===a&&(f=r.textNodes[0],u=f.length),e===c&&(d=r.textNodes[0],h=r.getLength())):r=null});var p=G(c,!o);if(p&&(r||(r=new H(c),l.push(r)),r.textNodes.push(p)),l.length){for(i=0,len=l.length;i<len;++i)l[i].doMerge(n);t.setStartAndEnd(f,u,d,h)}},createContainer:function(e){var t,n=k.getDocument(e),o=z&&!k.isHtmlNamespace(e)&&(t=e.namespaceURI)?n.createElementNS(e.namespaceURI,this.elementTagName):n.createElement(this.elementTagName);return this.copyPropertiesToElement(this.elementProperties,o,!1),this.copyAttributesToElement(this.elementAttributes,o),a(o,this.className),this.onElementCreate&&this.onElementCreate(o,this),o},elementHasProperties:function(e,t){var o=this;return n(t,function(t,n){if("className"==t)return u(e,n);if("object"==typeof n){if(!o.elementHasProperties(e[t],n))return!1}else if(e[t]!==n)return!1})},elementHasAttributes:function(e,t){return n(t,function(t,n){if(e.getAttribute(t)!==n)return!1})},applyToTextNode:function(e){if(h(e)){var t=e.parentNode;if(1==t.childNodes.length&&this.useExistingElements&&this.appliesToElement(t)&&this.elementHasProperties(t,this.elementProperties)&&this.elementHasAttributes(t,this.elementAttributes))a(t,this.className);else{var n=e.parentNode,o=this.createContainer(n);n.insertBefore(o,e),o.appendChild(e)}}},isRemovable:function(e){return e.tagName.toLowerCase()==this.elementTagName&&f(e)==this.elementSortedClassName&&this.elementHasProperties(e,this.elementProperties)&&!T(e,this.attrExceptions)&&this.elementHasAttributes(e,this.elementAttributes)&&this.isModifiable(e)},isEmptyContainer:function(e){var t=e.childNodes.length;return 1==e.nodeType&&this.isRemovable(e)&&(0==t||1==t&&this.isEmptyContainer(e.firstChild))},removeEmptyContainers:function(e){var t=this,n=e.getNodes([1],function(e){return t.isEmptyContainer(e)}),o=[e],i=A(o);W(n,function(e){v(e,i)}),_(o,i)},undoToTextNode:function(e,t,n,o){if(!t.containsNode(n)){var i=t.cloneRange();i.selectNode(n),i.isPointInRange(t.endContainer,t.endOffset)&&(D(n,t.endContainer,t.endOffset,o),t.setEndAfter(n)),i.isPointInRange(t.startContainer,t.startOffset)&&(n=D(n,t.startContainer,t.startOffset,o))}this.isRemovable(n)?w(n,o):Y(n,this.className)},splitAncestorWithClass:function(e,t,n){var o=this.getSelfOrAncestorWithClass(e);o&&D(o,e,t,n)},undoToAncestor:function(e,t){this.isRemovable(e)?w(e,t):Y(e,this.className)},applyToRange:function(e,t){var n=this;t=t||[];var o=A(t||[]);e.splitBoundariesPreservingPositions(o),n.removeEmptyElements&&n.removeEmptyContainers(e);var i=R(e);if(i.length){W(i,function(e){n.isIgnorableWhiteSpaceNode(e)||n.getSelfOrAncestorWithClass(e)||!n.isModifiable(e)||n.applyToTextNode(e,o)});var r=i[i.length-1];e.setStartAndEnd(i[0],0,r,r.length),n.normalize&&n.postApply(i,e,o,!1),_(t,o)}var s=n.getEmptyElements(e);W(s,function(e){a(e,n.className)})},applyToRanges:function(e){for(var t=e.length;t--;)this.applyToRange(e[t],e);return e},applyToSelection:function(t){var n=e.getSelection(t);n.setRanges(this.applyToRanges(n.getAllRanges()))},undoToRange:function(e,t){var n=this;t=t||[];var o=A(t);e.splitBoundariesPreservingPositions(o),n.removeEmptyElements&&n.removeEmptyContainers(e,o);var i,r,s=R(e),a=s[s.length-1];if(s.length){n.splitAncestorWithClass(e.endContainer,e.endOffset,o),n.splitAncestorWithClass(e.startContainer,e.startOffset,o);for(var c=0,l=s.length;c<l;++c)i=s[c],r=n.getSelfOrAncestorWithClass(i),r&&n.isModifiable(i)&&n.undoToAncestor(r,o);e.setStartAndEnd(s[0],0,a,a.length),n.normalize&&n.postApply(s,e,o,!0),_(t,o)}var f=n.getEmptyElements(e);W(f,function(e){Y(e,n.className)})},undoToRanges:function(e){for(var t=e.length;t--;)this.undoToRange(e[t],e);return e},undoToSelection:function(t){var n=e.getSelection(t),o=e.getSelection(t).getAllRanges();this.undoToRanges(o),n.setRanges(o)},isAppliedToRange:function(e){if(e.collapsed||""==e.toString())return!!this.getSelfOrAncestorWithClass(e.commonAncestorContainer);var t=e.getNodes([3]);if(t.length)for(var n,o=0;n=t[o++];)if(!this.isIgnorableWhiteSpaceNode(n)&&y(e,n)&&this.isModifiable(n)&&!this.getSelfOrAncestorWithClass(n))return!1;return!0},isAppliedToRanges:function(e){var t=e.length;if(0==t)return!1;for(;t--;)if(!this.isAppliedToRange(e[t]))return!1;return!0},isAppliedToSelection:function(t){var n=e.getSelection(t);return this.isAppliedToRanges(n.getAllRanges())},toggleRange:function(e){this.isAppliedToRange(e)?this.undoToRange(e):this.applyToRange(e)},toggleSelection:function(e){this.isAppliedToSelection(e)?this.undoToSelection(e):this.applyToSelection(e)},getElementsWithClassIntersectingRange:function(e){var t=[],n=this;return e.getNodes([3],function(e){var o=n.getSelfOrAncestorWithClass(e);o&&!L(t,o)&&t.push(o)}),t},detach:function(){}},B.util={hasClass:s,addClass:a,removeClass:Y,getClass:c,hasSameClasses:d,hasAllClasses:u,replaceWithOwnChildren:w,elementsHaveSameNonClassAttributes:N,elementHasNonClassAttributes:T,splitNodeAt:D,isEditableElement:V,isEditingHost:E,isEditable:b},e.CssClassApplier=e.ClassApplier=B,e.createClassApplier=$,j.createAliasForDeprecatedMethod(e,"createCssClassApplier","createClassApplier",t)}),e},this);